webpackJsonp([8],{"0BtF":function(e,t){},OHWv:function(e,t){},b46h:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("4OxD"),l=a("y7k7"),i=a("mse9"),r=a("P9l9"),o=a("ArgV"),n=(a("Dd8w"),a("mtWM")),d=a.n(n);a("mw3O");d.a.defaults.baseURL=l.a,d.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";var c=a("+6Bu"),u=a.n(c),p=a("mvHQ"),m=a.n(p),h=a("woOf"),f=a.n(h),b=(a("GXH0"),a("DmJO"),{props:["leadunits","users","leaderUsers","streetdatas","types","theight"],components:{},data:function(){return{isActive:!0,error:null,checkAll:!1,checkedItems:[],allitems:[],isIndeterminate:!1,choosenum:0,hasitem:[],submitType:[{value:1,type:"区间"},{value:3,type:"月"},{value:4,type:"季度"},{value:5,type:"天"}],timeday:[{value:"1",name:"1日"},{value:"2",name:"2日"},{value:"3",name:"3日"},{value:"4",name:"4日"},{value:"5",name:"5日"},{value:"6",name:"6日"},{value:"7",name:"7日"},{value:"8",name:"8日"},{value:"9",name:"9日"},{value:"10",name:"10日"},{value:"11",name:"11日"},{value:"12",name:"12日"},{value:"13",name:"13日"},{value:"14",name:"14日"},{value:"15",name:"15日"},{value:"16",name:"16日"},{value:"17",name:"17日"},{value:"18",name:"18日"},{value:"19",name:"19日"},{value:"20",name:"20日"},{value:"21",name:"21日"},{value:"22",name:"22日"},{value:"23",name:"23日"},{value:"24",name:"24日"},{value:"25",name:"25日"},{value:"26",name:"26日"},{value:"27",name:"27日"},{value:"28",name:"28日"},{value:"29",name:"29日"},{value:"30",name:"30日"},{value:"31",name:"31日"}],newtask:"",taskShow:!1,basicInfo:{category:"0",status:0},tasksData:[],leadsData:[],dutysData:[],addTaskData:{status:0},addLeadData:{},addDutyData:{},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"}],arealeadids:[{required:!0,message:"请选择牵头区领导",trigger:"blur"}],typeid:[{required:!0,message:"请选择项目类型",trigger:"blur"}]},addTaskVisible:!1,addLeadVisible:!1,addDutyVisible:!1,changeNum:"",changeWord:"",tindex:"-1",readOn:!1,taskTitle:"",ruleList:[],ruleVisible:!1,ruleTitle:"",ruleBtn:"",addRuleForm:{cycletype:1},weekList:[{value:"1",name:"周一"},{value:"2",name:"周二"},{value:"3",name:"周三"},{value:"4",name:"周四"},{value:"5",name:"周五"},{value:"6",name:"周六"},{value:"7",name:"周日"}],dateShow1:!0,dateShow2:!1,dateShow3:!1,dateShow4:!1,dateShow5:!1,region:"",monthday:"",quarter:"",weekday:"",daytime:"",cycleNum:1,ruleIndex:-1}},created:function(){},methods:{selectChange:function(){this.$forceUpdate()},ctypeFormat:function(e,t){switch(t){case 1:return"区间";case 2:return"周";case 3:return"月";case 4:return"季度";case 5:return"天"}},cycleChange:function(){switch(this.cycleNum=this.addRuleForm.cycletype,this.cycleNum){case 1:this.dateShow1=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1;break;case 2:this.dateShow2=!0,this.dateShow1=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1;break;case 3:this.dateShow3=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow4=!1,this.dateShow5=!1;break;case 4:this.dateShow4=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow3=!1,this.dateShow5=!1;break;case 5:this.dateShow5=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow1=!1}},addRuleBtn:function(){this.ruleVisible=!0,this.ruleTitle="新增报送规则",this.ruleBtn="新增",this.changeNum="add",this.classObject(),this.addRuleForm={cycletype:1},this.cycleChange()},addRuleSubmit:function(){var e=this;this.$refs.addRuleForm.validate(function(t){if(!t)return!1;e.cycleNum=e.addRuleForm.cycletype,1==e.cycleNum?e.addRuleForm.cycletime=e.region:2==e.cycleNum?e.addRuleForm.cycletime=e.weekday:3==e.cycleNum?e.addRuleForm.cycletime=e.monthday:4==e.cycleNum?e.addRuleForm.cycletime=e.quarter:5==e.cycleNum&&(e.addRuleForm.cycletime=e.daytime);var a=f()({},e.addRuleForm);e.ruleList.push(a),e.ruleVisible=!1,e.ruleTitle="",e.ruleBtn="",e.changeNum="",e.cycleNum=0,e.region="",e.monthday="",e.quarter="",e.weekday="",e.daytime=""})},editRuleBtn:function(e,t){this.hasitem=[],t.pidList?this.checkedItems=t.pidList:this.checkedItems=[];var a=t.cycletype;switch(this.cycleNum=t.cycletype,this.hasitem=[],a){case 1:this.dateShow1=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1,this.region=t.cycletime;break;case 2:this.dateShow2=!0,this.dateShow1=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1,this.weekday=t.cycletime;break;case 3:this.dateShow3=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow4=!1,this.dateShow5=!1,this.monthday=t.cycletime;break;case 4:this.dateShow4=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow3=!1,this.dateShow5=!1,this.quarter=t.cycletime;break;case 5:this.dateShow5=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow1=!1,this.daytime=t.cycletime}this.ruleVisible=!0,this.ruleTitle="编辑报送规则",this.ruleBtn="保存",this.changeNum="edit",this.addRuleForm=f()({},t),this.ruleIndex=e},editRuleSubmit:function(){var e=this;this.$refs.addRuleForm.validate(function(t){if(!t)return!1;var a={pidList:e.checkedItems,starttime:e.addRuleForm.starttime,endtime:e.addRuleForm.endtime};a=m()(a),Object(i.h)(a,function(t){if(e.hasitem=t.data.obj,e.hasitem.length>0)e.$confirm("<span style='color:#f00;'>红色标示的项目报送规则存在冲突</span>，请确认！","提示",{dangerouslyUseHTMLString:!0,type:"warning",center:!0,modal:!1,confirmButtonText:"确定"}).then(function(){for(var t=e.checkedItems,a=e.hasitem,s=[],l=[],i=0;i<a.length;i++)s[a[i]]=!0;for(var r=0;r<t.length;r++)s[t[r]]||l.push(t[r]);e.checkedItems=l});else{var a=f()({},e.addRuleForm);a.pidList=e.checkedItems,e.cycleNum=e.addRuleForm.cycletype,1==e.cycleNum?a.cycletime=e.region:2==e.cycleNum?a.cycletime=e.weekday:3==e.cycleNum?a.cycletime=e.monthday:4==e.cycleNum?a.cycletime=e.quarter:5==e.cycleNum&&(a.cycletime=e.daytime),e.ruleList.splice(e.ruleIndex,1,a),e.$refs.addRuleForm.resetFields(),e.ruleVisible=!1,e.ruleIndex=-1,e.ruleTitle="",e.ruleBtn="",e.changeNum="",e.cycleNum=0,e.region="",e.monthday="",e.quarter="",e.weekday="",e.daytime=""}})})},delRuleBtn:function(e,t){this.ruleList.splice(e,1),this.ruleVisible=!1,this.$message({message:"删除成功",type:"success"})},submitRule:function(){"add"==this.changeNum?this.addRuleSubmit():this.editRuleSubmit()},getTypes:function(){var e=this;Object(i.s)("",function(t){e.types=t.data.obj})},newTask:function(){var e=this,t={name:this.newtask};Object(i.d)(t,function(t){e.$message({message:"新增成功",type:"success"}),e.getTypes(),e.newtask=""})},goback:function(){var e=this;this.$confirm("<span style='color:#f00;'>数据未保存</span>，确定返回列表吗？","提示",{dangerouslyUseHTMLString:!0,type:"warning",center:!0,modal:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){e.$emit("my-event")}).catch(function(){return!1})},statusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case 3:return"滞后";case 4:return"严重滞后";case-1:return"完结"}},cellClassName:function(e){var t=e.row;e.column,e.rowIndex;switch(t.status){case 1:return"yellow";case 2:return"red";case 3:return"zh";case 4:return"zhou";case-1:return"gray"}},addLead:function(){this.changeNum="add",this.changeWord="新增",this.taskTitle="新增牵头单位",this.readOn=!1,this.addLeadVisible=!0},handleDetail2:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addLeadVisible=!0,this.addLeadData=f()({},t)},handleEdit2:function(e,t){this.changeNum="edit",this.changeWord="保存",this.taskTitle="编辑牵头单位",this.readOn=!1,this.addLeadVisible=!0,this.addLeadData=f()({},t),this.tindex=e},submitLead:function(){"read"==this.changeNum?this.addLeadVisible=!1:"add"==this.changeNum?this.addLeadSubmit():this.editLeadSubmit()},deptChange:function(){for(var e="",t=0;t<this.leadunits.length;t++)if(this.leadunits[t].id==this.addLeadData.deptid){e=this.leadunits[t].name;break}this.addLeadData.deptname=e},addLeadSubmit:function(){var e=this;this.$refs.addLeadData.validate(function(t){if(!t)return!1;var a=f()({},e.addLeadData);e.leadsData.push(a),e.$refs.addLeadData.resetFields(),e.addLeadVisible=!1})},editLeadSubmit:function(){var e=this;this.$refs.addLeadData.validate(function(t){if(!t)return console.log("error"),!1;var a=f()({},e.addLeadData);e.leadsData.splice(e.tindex,1,a),e.$refs.addLeadData.resetFields(),e.addLeadVisible=!1})},handleDelete2:function(e,t){this.leadsData.splice(e,1),this.$refs.addLeadData.resetFields(),this.addLeadVisible=!1,this.$message({message:"删除成功",type:"success"})},addDuty:function(){this.changeNum="add",this.changeWord="新增",this.taskTitle="新增责任单位",this.readOn=!1,this.addDutyVisible=!0},handleDetail3:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addDutyVisible=!0,this.addDutyData=f()({},t)},handleEdit3:function(e,t){this.changeNum="edit",this.changeWord="保存",this.taskTitle="编辑责任单位",this.readOn=!1,this.addDutyVisible=!0,this.addDutyData=f()({},t),this.tindex=e},submitDuty:function(){"read"==this.changeNum?this.addDutyVisible=!1:"add"==this.changeNum?this.addDutySubmit():this.editDutySubmit()},deptChange2:function(){for(var e="",t=0;t<this.leadunits.length;t++)if(this.leadunits[t].id==this.addDutyData.deptid){e=this.leadunits[t].name;break}this.addDutyData.deptname=e},addDutySubmit:function(){var e=this;this.$refs.addDutyData.validate(function(t){if(!t)return!1;console.log(e.addDutyData);var a=f()({},e.addDutyData);e.dutysData.push(a),e.$refs.addDutyData.resetFields(),e.addDutyVisible=!1})},editDutySubmit:function(){var e=this;this.$refs.addDutyData.validate(function(t){if(!t)return!1;var a=f()({},e.addDutyData);e.dutysData.splice(e.tindex,1,a),e.$refs.addDutyData.resetFields(),e.addDutyVisible=!1})},handleDelete3:function(e,t){this.dutysData.splice(e,1),this.$refs.addDutyData.resetFields(),this.addDutyVisible=!1,this.$message({message:"删除成功",type:"success"})},projectSubmitAll:function(){var e=this;this.$refs.basicInfo.validate(function(t){if(!t)return e.$message({message:"请输入项目名称",type:"warning"}),!1;if(e.leadsData==[])e.$message({message:"请添加牵头单位",type:"warning"});else{for(var a="",s=0;s<e.basicInfo.street.length;s++)a+=e.basicInfo.street[s]+",";e.basicInfo.streetids=a,e.basicInfo.street.length>1&&(a=a.substr(0,a.length-1));var l=e.basicInfo;l.arealeadids=e.basicInfo.arealeadids+",";var r=l;r.street;(l=u()(r,["street"])).leaderList=e.leadsData,l.dutyList=e.dutysData,l.ruleList=e.ruleList,l.totalstatus=0,l.formstatus=0,l=m()(l),Object(i.c)(l,function(t){if(-2==t.data.code)e.$message({message:t.data.msg,type:"error"});else if(0==t.data.code){var a={pid:t.data.obj};Object(i.g)(a,function(a){Object(i.t)({pid:t.data.obj},function(t){e.$emit("my-event"),e.$emit("getAll-event"),e.$message({message:"提交成功",type:"success"})})})}else e.$message({message:"新增失败",type:"error"}),e.$emit("my-event"),e.$emit("getAll-event")})}})}}}),v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addproject"},[a("div",{staticClass:"back"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.goback}},[e._v("返回")])],1),e._v(" "),a("div",{staticClass:"addcontent",style:e.theight},[a("el-row",{staticClass:"box"},[a("fieldset",[a("legend",[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"boxcontent basicbox"},[a("el-form",{ref:"basicInfo",attrs:{"label-width":"110px",size:"medium",rules:e.rules,inline:!0,model:e.basicInfo}},[a("div",{staticClass:"blist"},[a("el-form-item",{attrs:{label:"项目名称：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.basicInfo.name,callback:function(t){e.$set(e.basicInfo,"name",t)},expression:"basicInfo.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目业主：",prop:"owndeptid"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.basicInfo.owndeptid,callback:function(t){e.$set(e.basicInfo,"owndeptid",t)},expression:"basicInfo.owndeptid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("div",{staticClass:"blist"},[a("el-form-item",{staticClass:"ww1",attrs:{label:"牵头区领导：",prop:"arealeadids"}},[a("el-select",{attrs:{"collapse-tags":"",multiple:"",clearable:"",placeholder:"请选择"},model:{value:e.basicInfo.arealeadids,callback:function(t){e.$set(e.basicInfo,"arealeadids",t)},expression:"basicInfo.arealeadids"}},e._l(e.leaderUsers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"ww1",attrs:{label:"所属街道：",prop:"street"}},[a("el-select",{attrs:{filterable:"",multiple:"","collapse-tags":"",clearable:"",placeholder:"请选择"},model:{value:e.basicInfo.street,callback:function(t){e.$set(e.basicInfo,"street",t)},expression:"basicInfo.street"}},e._l(e.streetdatas,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("div",{staticClass:"blist"},[a("el-form-item",{staticClass:"bsrequire",attrs:{label:"报送要求：",prop:"submitres"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:3},model:{value:e.basicInfo.submitres,callback:function(t){e.$set(e.basicInfo,"submitres",t)},expression:"basicInfo.submitres"}})],1),e._v(" "),a("el-form-item",{staticClass:"bsrequire",attrs:{label:"项目描述：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:3},model:{value:e.basicInfo.remark,callback:function(t){e.$set(e.basicInfo,"remark",t)},expression:"basicInfo.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"blist"},[a("el-form-item",{attrs:{label:"项目类别：",prop:"category"}},[a("el-radio",{attrs:{label:"0"},on:{change:e.selectChange},model:{value:e.basicInfo.category,callback:function(t){e.$set(e.basicInfo,"category",t)},expression:"basicInfo.category"}},[e._v("一般项目")]),e._v(" "),a("el-radio",{attrs:{label:"1"},on:{change:e.selectChange},model:{value:e.basicInfo.category,callback:function(t){e.$set(e.basicInfo,"category",t)},expression:"basicInfo.category"}},[e._v("重点项目")])],1),e._v(" "),a("el-form-item",{attrs:{label:"项目地址：",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.basicInfo.address,callback:function(t){e.$set(e.basicInfo,"address",t)},expression:"basicInfo.address"}})],1)],1),e._v(" "),a("div",{staticClass:"blist"},[a("el-form-item",{attrs:{label:"经纬度：",prop:"mapitude"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.basicInfo.mapitude,callback:function(t){e.$set(e.basicInfo,"mapitude",t)},expression:"basicInfo.mapitude"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"目标任务：",prop:"aimplan"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:2},model:{value:e.basicInfo.aimplan,callback:function(t){e.$set(e.basicInfo,"aimplan",t)},expression:"basicInfo.aimplan"}})],1)],1)])],1)])]),e._v(" "),a("el-row",{staticClass:"box",attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("fieldset",[a("legend",[e._v("牵头单位")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-button",{staticClass:"addbtn",attrs:{size:"small",type:"primary"},on:{click:e.addLead}},[e._v("新 增")]),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.leadsData,"highlight-current-row":"",height:"150px","cell-class-name":e.cellClassName}},[a("el-table-column",{attrs:{prop:"deptname",label:"牵头单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"责任领导"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentname",label:"经办人"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleEdit2(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDelete2(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)]),e._v(" "),a("br"),e._v(" "),a("fieldset",[a("legend",[e._v("责任单位")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-button",{staticClass:"addbtn",attrs:{size:"small",type:"primary"},on:{click:e.addDuty}},[e._v("新 增")]),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.dutysData,"highlight-current-row":"",height:"150px","cell-class-name":e.cellClassName}},[a("el-table-column",{attrs:{prop:"deptname",label:"责任单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"责任领导"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentname",label:"经办人"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleEdit3(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDelete3(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("fieldset",{staticStyle:{width:"100%"}},[a("legend",[e._v("报送规则")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-button",{staticClass:"addbtn",attrs:{size:"small",type:"primary"},on:{click:e.addRuleBtn}},[e._v("新 增")]),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.ruleList,"highlight-current-row":"","cell-class-name":e.cellClassName,height:"440px"}},[a("el-table-column",{attrs:{prop:"stagename",label:"阶段"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cycletype",label:"报送周期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(e.ctypeFormat(t,t.row.cycletype))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"cycletime",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.cycletype?a("p",[e._v("每隔"+e._s(t.row.cycletime)+"天")]):3==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime)+"日")]):4==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime)+"日")]):5==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"warnday",label:"提前预警(天)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"starttime",label:"开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endtime",label:"结束时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.editRuleBtn(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticClass:"btn",on:{click:function(a){e.delRuleBtn(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)])])],1)],1),e._v(" "),a("div",{staticClass:"goback"},[a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.goback}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.projectSubmitAll}},[e._v("保 存")])],1),e._v(" "),a("el-dialog",{staticClass:"rule-dialog",attrs:{title:e.ruleTitle,visible:e.ruleVisible,width:"700px"},on:{"update:visible":function(t){e.ruleVisible=t}}},[a("el-form",{ref:"addRuleForm",attrs:{model:e.addRuleForm,inline:!0,"label-width":"93px","append-to-body":!0,size:"small"}},[a("el-form-item",{attrs:{label:"阶段：",prop:"stagename"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addRuleForm.stagename,callback:function(t){e.$set(e.addRuleForm,"stagename",t)},expression:"addRuleForm.stagename"}})],1),e._v(" "),a("el-form-item",{staticClass:"day",attrs:{label:"提前：",prop:"warnday"}},[a("el-input",{model:{value:e.addRuleForm.warnday,callback:function(t){e.$set(e.addRuleForm,"warnday",t)},expression:"addRuleForm.warnday"}},[a("template",{slot:"append"},[e._v("天预警")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"报送周期：",prop:"cycletype"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){e.cycleChange()}},model:{value:e.addRuleForm.cycletype,callback:function(t){e.$set(e.addRuleForm,"cycletype",t)},expression:"addRuleForm.cycletype"}},e._l(e.submitType,function(e){return a("el-option",{key:e.value,attrs:{label:e.type,value:e.value}})}))],1),e._v(" "),e.dateShow1?a("el-form-item",{staticClass:"day",attrs:{label:"每隔：",prop:"region"}},[a("el-input",{model:{value:e.region,callback:function(t){e.region=t},expression:"region"}},[a("template",{slot:"append"},[e._v("天报送")])],2)],1):e._e(),e._v(" "),e.dateShow2?a("el-form-item",{attrs:{label:"日期：",prop:"weekday"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}},e._l(e.weekList,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow3?a("el-form-item",{attrs:{label:"日期：",prop:"monthday"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.monthday,callback:function(t){e.monthday=t},expression:"monthday"}},e._l(e.timeday,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow4?a("el-form-item",{attrs:{label:"日期：",prop:"quarter"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.quarter,callback:function(t){e.quarter=t},expression:"quarter"}},e._l(e.timeday,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow5?a("el-form-item",{attrs:{label:"日期：",prop:"daytime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.daytime,callback:function(t){e.daytime=t},expression:"daytime"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"starttime",rules:[{required:!0,message:"时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.addRuleForm.starttime,callback:function(t){e.$set(e.addRuleForm,"starttime",t)},expression:"addRuleForm.starttime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"endtime",rules:[{required:!0,message:"时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.addRuleForm.endtime,callback:function(t){e.$set(e.addRuleForm,"endtime",t)},expression:"addRuleForm.endtime"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitRule}},[e._v(e._s(e.ruleBtn))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog task-dialog2",attrs:{title:e.taskTitle,visible:e.addLeadVisible,width:"800px"},on:{"update:visible":function(t){e.addLeadVisible=t}}},[a("el-form",{ref:"addLeadData",attrs:{inline:!0,model:e.addLeadData,"label-width":"100px","append-to-body":!0}},[a("div",{staticClass:"leabox"},[a("el-form-item",{attrs:{label:"牵头单位：",prop:"deptid",rules:[{required:!0,message:"请选择牵头单位",trigger:"change"}]}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:e.deptChange},model:{value:e.addLeadData.deptid,callback:function(t){e.$set(e.addLeadData,"deptid",t)},expression:"addLeadData.deptid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"责任领导：",prop:"leadername"}},[a("el-input",{model:{value:e.addLeadData.leadername,callback:function(t){e.$set(e.addLeadData,"leadername",t)},expression:"addLeadData.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"leaderphone"}},[a("el-input",{model:{value:e.addLeadData.leaderphone,callback:function(t){e.$set(e.addLeadData,"leaderphone",t)},expression:"addLeadData.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人：",prop:"agentname"}},[a("el-input",{model:{value:e.addLeadData.agentname,callback:function(t){e.$set(e.addLeadData,"agentname",t)},expression:"addLeadData.agentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"agentphone"}},[a("el-input",{model:{value:e.addLeadData.agentphone,callback:function(t){e.$set(e.addLeadData,"agentphone",t)},expression:"addLeadData.agentphone"}})],1),e._v(" "),a("div",{staticClass:"leabox leabox2"},[a("el-form-item",{attrs:{label:"工作职责：",prop:"duty"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10}},model:{value:e.addLeadData.duty,callback:function(t){e.$set(e.addLeadData,"duty",t)},expression:"addLeadData.duty"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitLead}},[e._v(e._s(e.changeWord))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog task-dialog2",attrs:{title:e.taskTitle,visible:e.addDutyVisible,width:"800px"},on:{"update:visible":function(t){e.addDutyVisible=t}}},[a("el-form",{ref:"addDutyData",attrs:{inline:!0,model:e.addDutyData,"label-width":"100px","append-to-body":!0}},[a("div",{staticClass:"leabox"},[a("el-form-item",{attrs:{label:"责任单位：",prop:"deptid",rules:[{required:!0,message:"请选择责任单位",trigger:"change"}]}},[a("el-select",{attrs:{clearable:"",filterable:"",readonly:e.readOn,placeholder:"请选择"},on:{change:e.deptChange2},model:{value:e.addDutyData.deptid,callback:function(t){e.$set(e.addDutyData,"deptid",t)},expression:"addDutyData.deptid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"责任领导：",prop:"leadername"}},[a("el-input",{model:{value:e.addDutyData.leadername,callback:function(t){e.$set(e.addDutyData,"leadername",t)},expression:"addDutyData.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"leaderphone"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.leaderphone,callback:function(t){e.$set(e.addDutyData,"leaderphone",t)},expression:"addDutyData.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人：",prop:"agentname"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.agentname,callback:function(t){e.$set(e.addDutyData,"agentname",t)},expression:"addDutyData.agentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"agentphone"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.agentphone,callback:function(t){e.$set(e.addDutyData,"agentphone",t)},expression:"addDutyData.agentphone"}})],1),e._v(" "),a("div",{staticClass:"leabox leabox2"},[a("el-form-item",{attrs:{label:"工作职责：",prop:"duty"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10},readonly:e.readOn},model:{value:e.addDutyData.duty,callback:function(t){e.$set(e.addDutyData,"duty",t)},expression:"addDutyData.duty"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitDuty}},[e._v(e._s(e.changeWord))])],1)],1)],1)},staticRenderFns:[]};var y=a("VU/8")(b,v,!1,function(e){a("OHWv")},null,null).exports,g={props:["leadunits","users","projectDetailData","leadsData","dutysData","addheight2","projectId","ruleList","isEditShow","noEdit","historyHeight","newReportList","lastprogress","isCenter"],components:{},data:function(){return{statusLabel:["../../../static/images/s0.png","../../../static/images/s1.png","../../../static/images/s2.png","../../../static/images/s3.png"],dimgs:["../../../static/images/1.jpg","../../../static/images/2.jpg","../../../static/images/3.jpg"],imgNum:"",types:[],addTaskData:{},addLeadData:{},addDutyData:{},addTaskVisible:!1,addLeadVisible:!1,addDutyVisible:!1,imgVisible:!1,changeNum:"",changeWord:"",tindex:"-1",readOn:!1,taskTitle:"",upfile:"",imgIp:"",isDetailShow:!0,isHistoryShow:!1,historyData:[],ruleVisible:!1,dateShow1:!1,dateShow2:!1,dateShow3:!1,dateShow4:!1,dateShow5:!1,region:"",monthday:"",quarter:"",weekday:"",daytime:"",cycleNum:0,addRuleForm:{},weekList:[{value:"1",name:"周一"},{value:"2",name:"周二"},{value:"3",name:"周三"},{value:"4",name:"周四"},{value:"5",name:"周五"},{value:"6",name:"周六"},{value:"7",name:"周日"}],submitType:[{value:1,type:"区间"},{value:3,type:"月"},{value:4,type:"季度"},{value:5,type:"天"}],timeday:[{value:"1",name:"1日"},{value:"2",name:"2日"},{value:"3",name:"3日"},{value:"4",name:"4日"},{value:"5",name:"5日"},{value:"6",name:"6日"},{value:"7",name:"7日"},{value:"8",name:"8日"},{value:"9",name:"9日"},{value:"10",name:"10日"},{value:"11",name:"11日"},{value:"12",name:"12日"},{value:"13",name:"13日"},{value:"14",name:"14日"},{value:"15",name:"15日"},{value:"16",name:"16日"},{value:"17",name:"17日"},{value:"18",name:"18日"},{value:"19",name:"19日"},{value:"20",name:"20日"},{value:"21",name:"21日"},{value:"22",name:"22日"},{value:"23",name:"23日"},{value:"24",name:"24日"},{value:"25",name:"25日"},{value:"26",name:"26日"},{value:"27",name:"27日"},{value:"28",name:"28日"},{value:"29",name:"29日"},{value:"30",name:"30日"},{value:"31",name:"31日"}]}},created:function(){this.upfile=s.j,this.imgIp=s.a,this.statusImg()},methods:{formstatusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case-1:return"完结"}},toEdit:function(){this.$emit("edit-event")},stateFormat:function(e,t){switch(t){case 2:return"未执行";case 1:return"执行中";case 0:return"失效"}},ctypeFormat:function(e,t){switch(t){case 1:return"区间";case 2:return"周";case 3:return"月";case 4:return"季度";case 5:return"天"}},detailRuleBtn:function(e,t){switch(console.log(t),t.cycletype){case 1:this.dateShow1=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1,this.region=t.cycletime;break;case 2:this.dateShow2=!0,this.dateShow1=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1,this.weekday=t.cycletime;break;case 3:this.dateShow3=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow4=!1,this.dateShow5=!1,this.monthday=t.cycletime;break;case 4:this.dateShow4=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow3=!1,this.dateShow5=!1,this.quarter=t.cycletime;break;case 5:this.dateShow5=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow1=!1,this.daytime=t.cycletime}this.ruleVisible=!0,this.addRuleForm=f()({},t),this.addRuleForm.endtime=new Date(this.addRuleForm.endtime),this.addRuleForm.starttime=new Date(this.addRuleForm.starttime),this.addRuleForm.endtime=new Date(this.addRuleForm.endtime)},submitRule:function(){this.ruleVisible=!1},timestampToTime2:function(e,t){var a=new Date(e.createtime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+a.getDate()},endtimeToTime:function(e,t){var a=new Date(e.endtime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+a.getDate()},starttimeToTime:function(e,t){var a=new Date(e.starttime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+a.getDate()},validateFormat:function(e,t){switch(t){case 0:return"未审核";case 1:return"审核未通过";case 2:return"审核通过"}},nullFormat:function(e,t){return"null"==t||null==t?"<span>/</span>":"<span>"+t+"</span>"},lookHistory:function(){var e=this;console.log(this.projectId);var t={projectid:this.projectId};Object(i.q)(t,function(t){e.historyData=t.data.obj,console.log(e.historyData);for(var a=[],s=0;s<e.historyData.length;s++){var l=e.historyData[s].filepath,i=[];if(null==l)i=[];else{var r=(a=l.split(",")).length;""==a[r-1]&&a.splice(r-1,1);for(var o=a,n=0;n<o.length;n++){var d={};d.url=e.imgIp+o[n],d.name=o[n],i.push(d)}}e.historyData[s].filepath=i,console.log(i)}e.isDetailShow=!1,e.isHistoryShow=!0})},returnDetail:function(){this.isDetailShow=!0,this.isHistoryShow=!1},timestampToTime:function(e,t){var a=new Date(e.stoptime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+(a.getDate()+" ")},statusImg:function(){switch(this.projectDetailData.status){case 0:return this.imgNum=0;case 1:return this.imgNum=1;case 2:return this.imgNum=2;case-1:return this.imgNum=3}},lookimg:function(){this.imgVisible=!0},goback:function(){1==this.isCenter?this.$router.push({path:"/index"}):2==this.isCenter?this.$router.push({path:"/personCenter"}):this.$emit("my-event")},statusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case 3:return"滞后";case 4:return"严重滞后";case-1:return"完结"}},cellClassName:function(e){var t=e.row;e.column,e.rowIndex;switch(t.status){case 1:return"yellow";case 2:return"red";case 3:return"zh";case 4:return"zhou";case-1:return"gray"}},handleDetail:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addTaskVisible=!0,this.addTaskData=f()({},t)},submitTask:function(){this.addTaskVisible=!1},handleDetail2:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addLeadVisible=!0,this.addLeadData=f()({},t)},submitLead:function(){this.addLeadVisible=!1},handleDetail3:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addDutyVisible=!0,this.addDutyData=f()({},t)},submitDuty:function(){this.addDutyVisible=!1}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addproject"},[e.isDetailShow?a("div",{staticClass:"isDetailShow"},[a("div",{staticClass:"back"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.goback}},[e._v("返回")]),e._v(" "),e.isEditShow?a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.noEdit,expression:"noEdit"}],class:2==e.isCenter?"noeditbtn":"",attrs:{size:"small",type:"primary"},on:{click:e.toEdit}},[e._v("编辑")]):e._e()],1),e._v(" "),a("div",{staticClass:"addcontent",style:e.addheight2},[a("el-row",{staticClass:"box",staticStyle:{display:"flex","align-items":"stretch"},attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("fieldset",{staticStyle:{height:"100%"}},[a("legend",[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"detail-basic"},[a("el-form",{ref:"projectDetailData",attrs:{size:"medium","label-width":"96px",model:e.projectDetailData}},[a("div",{staticClass:"blist"},[a("el-form-item",{attrs:{label:"项目名称：",prop:"projectName"}},[a("el-input",{attrs:{readonly:""},model:{value:e.projectDetailData.projectName,callback:function(t){e.$set(e.projectDetailData,"projectName",t)},expression:"projectDetailData.projectName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目业主：",prop:"ownName"}},[a("el-input",{attrs:{readonly:""},model:{value:e.projectDetailData.ownName,callback:function(t){e.$set(e.projectDetailData,"ownName",t)},expression:"projectDetailData.ownName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"牵头区领导：",prop:"arealeaderNames"}},[a("el-input",{attrs:{readonly:""},model:{value:e.projectDetailData.arealeaderNames,callback:function(t){e.$set(e.projectDetailData,"arealeaderNames",t)},expression:"projectDetailData.arealeaderNames"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属街道：",prop:"streets"}},[a("el-input",{attrs:{readonly:""},model:{value:e.projectDetailData.streets,callback:function(t){e.$set(e.projectDetailData,"streets",t)},expression:"projectDetailData.streets"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目类别：",prop:"category"}},[a("el-input",{attrs:{readonly:""},model:{value:e.projectDetailData.category,callback:function(t){e.$set(e.projectDetailData,"category",t)},expression:"projectDetailData.category"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目地址：",prop:"address"}},[a("el-input",{attrs:{readonly:""},model:{value:e.projectDetailData.address,callback:function(t){e.$set(e.projectDetailData,"address",t)},expression:"projectDetailData.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经纬度：",prop:"mapitude"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.projectDetailData.mapitude,callback:function(t){e.$set(e.projectDetailData,"mapitude",t)},expression:"projectDetailData.mapitude"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"报送要求：",prop:"submitres"}},[a("el-input",{attrs:{type:"textarea",rows:2,readonly:""},model:{value:e.projectDetailData.submitres,callback:function(t){e.$set(e.projectDetailData,"submitres",t)},expression:"projectDetailData.submitres"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目描述：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",rows:2,readonly:""},model:{value:e.projectDetailData.remark,callback:function(t){e.$set(e.projectDetailData,"remark",t)},expression:"projectDetailData.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"目标任务：",prop:"aimplan"}},[a("el-input",{attrs:{type:"textarea",rows:2,readonly:""},model:{value:e.projectDetailData.aimplan,callback:function(t){e.$set(e.projectDetailData,"aimplan",t)},expression:"projectDetailData.aimplan"}})],1)],1)]),e._v(" "),a("div",{staticClass:"stateId"},[a("img",{attrs:{src:e.statusLabel[e.imgNum],alt:""}})])],1)])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("fieldset",{staticClass:"plist",staticStyle:{height:"100%",overflow:"hidden"}},[a("legend",[e._v("报送材料")]),e._v(" "),a("div",{staticClass:"unitbox"},[a("el-button",{staticStyle:{margin:"15px 30px"},attrs:{size:"small",type:"primary"},on:{click:e.lookHistory}},[e._v("报送历史")]),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"speed"},[a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("上次进展情况：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.lastprogress,function(t,s){return a("p",{key:s},[e._v(e._s(t.question))])}))]),e._v(" "),a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("进展情况：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.newReportList,function(t,s){return a("p",{key:s},[e._v(e._s(t.question))])}))]),e._v(" "),a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("存在问题：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.newReportList,function(t,s){return a("p",{key:s},[e._v(e._s(t.wenti))])}))]),e._v(" "),a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("下步工作计划：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.newReportList,function(t,s){return a("p",{key:s},[e._v(e._s(t.measure))])}))]),e._v(" "),a("div",{staticClass:"filelist"},[a("p",{staticClass:"tt"},[e._v("附件")]),e._v(" "),a("div",{staticClass:"list"},[a("div",e._l(e.newReportList,function(t,s){return a("div",{key:s},e._l(t.newFiles,function(t,l){return a("div",{key:l},[a("a",{staticClass:"filetitle",staticStyle:{"text-align":"left"},attrs:{href:t.url,target:"_blank"}},[e._v(e._s(s+1)+". "+e._s(t.name))])])}))}))])])])],1)])])],1),e._v(" "),a("el-row",{staticClass:"box",attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("fieldset",[a("legend",[e._v("牵头单位")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-table",{staticClass:"tableinfo dtable",staticStyle:{width:"100%"},attrs:{border:"",data:e.leadsData,"highlight-current-row":"",height:"160px","cell-class-name":e.cellClassName}},[a("el-table-column",{attrs:{prop:"deptName",label:"牵头单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"责任领导"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentname",label:"经办人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"formstatus",label:"报送状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tag",{attrs:{size:"small"}},[1==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#fbe804"}}):2==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#f00"}}):-1==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#999"}}):a("i",{staticClass:"fa mark"}),e._v(" "),a("span",{domProps:{innerHTML:e._s(e.formstatusFormat(t,t.row.formstatus))}})])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDetail2(t.$index,t.row)}}},[e._v("详情")])]}}])})],1)],1)]),e._v(" "),a("br"),e._v(" "),a("fieldset",[a("legend",[e._v("责任单位")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-table",{staticClass:"tableinfo dtable",staticStyle:{width:"100%"},attrs:{border:"",data:e.dutysData,height:"160px","highlight-current-row":"","cell-class-name":e.cellClassName}},[a("el-table-column",{attrs:{prop:"deptName",label:"责任单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"责任领导"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentname",label:"经办人"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDetail3(t.$index,t.row)}}},[e._v("详情")])]}}])})],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("fieldset",[a("legend",[e._v("报送规则")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.ruleList,"highlight-current-row":"",height:"400px"}},[a("el-table-column",{attrs:{prop:"stagename",label:"阶段"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cycletype",label:"报送周期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(e.ctypeFormat(t,t.row.cycletype))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"cycletime",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.cycletype?a("p",[e._v("每隔"+e._s(t.row.cycletime)+"天")]):e._e(),e._v(" "),2==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime))]):3==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime)+"日")]):4==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime)+"日")]):5==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"warnday",label:"提前预警(天)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"starttime",formatter:e.starttimeToTime,label:"开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endtime",formatter:e.endtimeToTime,label:"结束时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tag",{attrs:{size:"medium"}},[1==t.row.status?a("i",{staticClass:"fa mark",staticStyle:{background:"#364e98"}}):0==t.row.status?a("i",{staticClass:"fa mark",staticStyle:{background:"#999"}}):a("i",{staticClass:"fa mark"}),e._v(" "),a("span",{domProps:{innerHTML:e._s(e.stateFormat(t,t.row.status))}})])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.detailRuleBtn(t.$index,t.row)}}},[e._v("详情")])]}}])})],1)],1)])])],1)],1),e._v(" "),a("el-dialog",{staticClass:"img-dialog",attrs:{visible:e.imgVisible,width:"800px"},on:{"update:visible":function(t){e.imgVisible=t}}},[a("el-carousel",{attrs:{height:"500px"}},e._l(e.dimgs,function(e){return a("el-carousel-item",{key:e},[a("img",{attrs:{src:e,alt:""}})])}))],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog",attrs:{title:e.taskTitle,visible:e.addTaskVisible,width:"800px"},on:{"update:visible":function(t){e.addTaskVisible=t}}},[a("el-form",{ref:"addTaskData",attrs:{model:e.addTaskData,"label-width":"100px","append-to-body":!0}},[a("el-form-item",{attrs:{label:"目标任务：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:5},readonly:e.readOn},model:{value:e.addTaskData.remark,callback:function(t){e.$set(e.addTaskData,"remark",t)},expression:"addTaskData.remark"}})],1),e._v(" "),a("div",{staticClass:"taskbox"},[a("el-form-item",{attrs:{label:"最后截止时间",prop:"stoptime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date",readonly:e.readOn,placeholder:"请选择"},model:{value:e.addTaskData.stoptime,callback:function(t){e.$set(e.addTaskData,"stoptime",t)},expression:"addTaskData.stoptime"}})],1),e._v(" "),a("el-form-item",{staticClass:"day",attrs:{label:"提前：",prop:"warntime"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addTaskData.warntime,callback:function(t){e.$set(e.addTaskData,"warntime",t)},expression:"addTaskData.warntime"}},[a("template",{slot:"append"},[e._v("天预警")])],2)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitTask}},[e._v(e._s(e.changeWord))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog task-dialog2",attrs:{title:e.taskTitle,visible:e.addLeadVisible,width:"800px"},on:{"update:visible":function(t){e.addLeadVisible=t}}},[a("el-form",{ref:"addLeadData",attrs:{inline:!0,model:e.addLeadData,"label-width":"100px","append-to-body":!0}},[a("div",{staticClass:"leabox"},[a("el-form-item",{attrs:{label:"牵头单位：",prop:"deptName"}},[a("el-input",{model:{value:e.addLeadData.deptName,callback:function(t){e.$set(e.addLeadData,"deptName",t)},expression:"addLeadData.deptName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"责任领导：",prop:"leadername"}},[a("el-input",{model:{value:e.addLeadData.leadername,callback:function(t){e.$set(e.addLeadData,"leadername",t)},expression:"addLeadData.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"leaderphone"}},[a("el-input",{model:{value:e.addLeadData.leaderphone,callback:function(t){e.$set(e.addLeadData,"leaderphone",t)},expression:"addLeadData.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人：",prop:"agentname"}},[a("el-input",{model:{value:e.addLeadData.agentname,callback:function(t){e.$set(e.addLeadData,"agentname",t)},expression:"addLeadData.agentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"agentphone"}},[a("el-input",{model:{value:e.addLeadData.agentphone,callback:function(t){e.$set(e.addLeadData,"agentphone",t)},expression:"addLeadData.agentphone"}})],1),e._v(" "),a("div",{staticClass:"leabox leabox2"},[a("el-form-item",{attrs:{label:"工作职责：",prop:"duty"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:5}},model:{value:e.addLeadData.duty,callback:function(t){e.$set(e.addLeadData,"duty",t)},expression:"addLeadData.duty"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitLead}},[e._v(e._s(e.changeWord))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog task-dialog2",attrs:{title:e.taskTitle,visible:e.addDutyVisible,width:"800px"},on:{"update:visible":function(t){e.addDutyVisible=t}}},[a("el-form",{ref:"addDutyData",attrs:{inline:!0,model:e.addDutyData,"label-width":"100px","append-to-body":!0}},[a("div",{staticClass:"leabox"},[a("el-form-item",{attrs:{label:"责任单位：",prop:"deptName"}},[a("el-input",{model:{value:e.addDutyData.deptName,callback:function(t){e.$set(e.addDutyData,"deptName",t)},expression:"addDutyData.deptName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"责任领导：",prop:"leadername"}},[a("el-input",{model:{value:e.addDutyData.leadername,callback:function(t){e.$set(e.addDutyData,"leadername",t)},expression:"addDutyData.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"leaderphone"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.leaderphone,callback:function(t){e.$set(e.addDutyData,"leaderphone",t)},expression:"addDutyData.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人：",prop:"agentname"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.agentname,callback:function(t){e.$set(e.addDutyData,"agentname",t)},expression:"addDutyData.agentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"agentphone"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.agentphone,callback:function(t){e.$set(e.addDutyData,"agentphone",t)},expression:"addDutyData.agentphone"}})],1),e._v(" "),a("div",{staticClass:"leabox leabox2"},[a("el-form-item",{attrs:{label:"工作职责：",prop:"duty"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:5},readonly:e.readOn},model:{value:e.addDutyData.duty,callback:function(t){e.$set(e.addDutyData,"duty",t)},expression:"addDutyData.duty"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitDuty}},[e._v(e._s(e.changeWord))])],1)],1)],1):e._e(),e._v(" "),a("el-dialog",{staticClass:"rule-dialog",attrs:{title:"详情",visible:e.ruleVisible,width:"700px"},on:{"update:visible":function(t){e.ruleVisible=t}}},[a("el-form",{ref:"addRuleForm",attrs:{model:e.addRuleForm,inline:!0,"label-width":"93px","append-to-body":!0}},[a("el-form-item",{attrs:{label:"阶段：",prop:"stagename"}},[a("el-input",{attrs:{readonly:"",placeholder:"请输入"},model:{value:e.addRuleForm.stagename,callback:function(t){e.$set(e.addRuleForm,"stagename",t)},expression:"addRuleForm.stagename"}})],1),e._v(" "),a("el-form-item",{staticClass:"day",attrs:{label:"提前：",prop:"warnday"}},[a("el-input",{attrs:{readonly:""},model:{value:e.addRuleForm.warnday,callback:function(t){e.$set(e.addRuleForm,"warnday",t)},expression:"addRuleForm.warnday"}},[a("template",{slot:"append"},[e._v("天预警")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"报送周期：",prop:"cycletype"}},[a("el-select",{attrs:{clearable:"",disabled:""},model:{value:e.addRuleForm.cycletype,callback:function(t){e.$set(e.addRuleForm,"cycletype",t)},expression:"addRuleForm.cycletype"}},e._l(e.submitType,function(e){return a("el-option",{key:e.value,attrs:{label:e.type,value:e.value}})}))],1),e._v(" "),e.dateShow1?a("el-form-item",{staticClass:"day",attrs:{label:"每隔：",prop:"region"}},[a("el-input",{attrs:{readonly:""},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}},[a("template",{slot:"append"},[e._v("天报送")])],2)],1):e._e(),e._v(" "),e.dateShow2?a("el-form-item",{attrs:{label:"日期：",prop:"weekday"}},[a("el-select",{attrs:{clearable:"",readonly:""},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}},e._l(e.weekList,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow3?a("el-form-item",{attrs:{label:"日期：",prop:"monthday"}},[a("el-select",{attrs:{clearable:"",readonly:""},model:{value:e.monthday,callback:function(t){e.monthday=t},expression:"monthday"}},e._l(e.timeday,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow4?a("el-form-item",{attrs:{label:"日期：",prop:"quarter"}},[a("el-select",{attrs:{clearable:"",readonly:""},model:{value:e.quarter,callback:function(t){e.quarter=t},expression:"quarter"}},e._l(e.timeday,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow5?a("el-form-item",{attrs:{label:"日期：",prop:"daytime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",readonly:""},model:{value:e.daytime,callback:function(t){e.daytime=t},expression:"daytime"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"starttime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date",readonly:"","value-format":"yyyy-MM-dd"},model:{value:e.addRuleForm.starttime,callback:function(t){e.$set(e.addRuleForm,"starttime",t)},expression:"addRuleForm.starttime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"endtime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date",readonly:"","value-format":"yyyy-MM-dd"},model:{value:e.addRuleForm.endtime,callback:function(t){e.$set(e.addRuleForm,"endtime",t)},expression:"addRuleForm.endtime"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitRule}},[e._v("确定")])],1)],1),e._v(" "),e.isHistoryShow?a("div",{staticClass:"history"},[a("p",{staticClass:"title"},[e._v("历史回执")]),e._v(" "),a("div",{staticClass:"hbtns"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.returnDetail}},[e._v("返 回")])],1),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%",overflow:"auto"},attrs:{border:"",data:e.historyData,"highlight-current-row":"",height:e.historyHeight}},[a("el-table-column",{attrs:{prop:"reportdept",label:"报送单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"question",label:"进展情况"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wenti",label:"存在问题"}}),e._v(" "),a("el-table-column",{attrs:{prop:"measure",label:"下步工作计划"}}),e._v(" "),a("el-table-column",{attrs:{prop:"validate",label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(e.validateFormat(t,t.row.validate))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createtime",label:"填报时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("dateformat")(t.row.createtime,"YYYY-MM-DD HH:mm:ss")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"reason",label:"审核不通过原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{domProps:{innerHTML:e._s(e.nullFormat(t,t.row.reason))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"filepath",label:"附件"},scopedSlots:e._u([{key:"default",fn:function(t){return[null==t.row.filepath||""==t.row.filepath?a("p",[e._v("无")]):e._l(t.row.filepath,function(t,s){return a("a",{key:s,staticClass:"filetitle",staticStyle:{"text-align":"left"},attrs:{href:t.url,target:"_blank"}},[e._v(e._s(s+1)+". "+e._s(t.name))])})]}}])})],1)],1):e._e()],1)},staticRenderFns:[]};var D=a("VU/8")(g,w,!1,function(e){a("0BtF")},null,null).exports,_={props:["leadunits","users","projectId","basicInfo","leadsData","dutysData","leaderUsers","types","streetdatas","theight","ruleList","newReportList","lastprogress"],components:{},data:function(){return{checkAll:!1,checkedItems:[],allitems:[],isIndeterminate:!1,choosenum:0,hasitem:[],newtask:"",taskShow:!1,addTaskData:{status:0},addLeadData:{},addDutyData:{},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"}],arealeadids:[{required:!0,message:"请选择牵头区领导",trigger:"blur"}],typeid:[{required:!0,message:"请选择项目类型",trigger:"blur"}]},addTaskVisible:!1,addLeadVisible:!1,addDutyVisible:!1,changeNum:"",changeWord:"",tindex:"-1",readOn:!1,taskTitle:"",ruleVisible:!1,dateShow1:!1,dateShow2:!1,dateShow3:!1,dateShow4:!1,dateShow5:!1,region:"",monthday:"",quarter:"",weekday:"",daytime:"",ruleTitle:"",ruleBtn:"",cycleNum:0,addRuleForm:{cycletype:1},weekList:[{value:"1",name:"周一"},{value:"2",name:"周二"},{value:"3",name:"周三"},{value:"4",name:"周四"},{value:"5",name:"周五"},{value:"6",name:"周六"},{value:"7",name:"周日"}],submitType:[{value:1,type:"区间"},{value:3,type:"月"},{value:4,type:"季度"},{value:5,type:"天"}],timeday:[{value:"1",name:"1日"},{value:"2",name:"2日"},{value:"3",name:"3日"},{value:"4",name:"4日"},{value:"5",name:"5日"},{value:"6",name:"6日"},{value:"7",name:"7日"},{value:"8",name:"8日"},{value:"9",name:"9日"},{value:"10",name:"10日"},{value:"11",name:"11日"},{value:"12",name:"12日"},{value:"13",name:"13日"},{value:"14",name:"14日"},{value:"15",name:"15日"},{value:"16",name:"16日"},{value:"17",name:"17日"},{value:"18",name:"18日"},{value:"19",name:"19日"},{value:"20",name:"20日"},{value:"21",name:"21日"},{value:"22",name:"22日"},{value:"23",name:"23日"},{value:"24",name:"24日"},{value:"25",name:"25日"},{value:"26",name:"26日"},{value:"27",name:"27日"},{value:"28",name:"28日"},{value:"29",name:"29日"},{value:"30",name:"30日"},{value:"31",name:"31日"}],ruleIndex:-1}},created:function(){},methods:{formstatusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case-1:return"完结"}},endtimeToTime:function(e,t){var a=new Date(e.endtime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+a.getDate()},starttimeToTime:function(e,t){var a=new Date(e.starttime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+a.getDate()},ctypeFormat:function(e,t){switch(t){case 1:return"区间";case 2:return"周";case 3:return"月";case 4:return"季度";case 5:return"天"}},cycleChange:function(){switch(this.cycleNum=this.addRuleForm.cycletype,this.cycleNum){case 1:this.dateShow1=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1;break;case 2:this.dateShow2=!0,this.dateShow1=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1;break;case 3:this.dateShow3=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow4=!1,this.dateShow5=!1;break;case 4:this.dateShow4=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow3=!1,this.dateShow5=!1;break;case 5:this.dateShow5=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow1=!1}},addRuleBtn:function(){this.ruleVisible=!0,this.ruleTitle="新增报送规则",this.ruleBtn="新增",this.changeNum="add",this.addRuleForm={cycletype:1},this.cycleChange()},addRuleSubmit:function(){var e=this;this.$refs.addRuleForm.validate(function(t){if(!t)return!1;e.cycleNum=e.addRuleForm.cycletype,1==e.cycleNum?e.addRuleForm.cycletime=e.region:2==e.cycleNum?e.addRuleForm.cycletime=e.weekday:3==e.cycleNum?e.addRuleForm.cycletime=e.monthday:4==e.cycleNum?e.addRuleForm.cycletime=e.quarter:5==e.cycleNum&&(e.addRuleForm.cycletime=e.daytime);var a=f()({},e.addRuleForm);e.ruleList.push(a),e.$refs.addRuleForm.resetFields(),e.ruleVisible=!1,e.ruleTitle="",e.ruleBtn="",e.changeNum="",e.cycleNum=0})},editRuleBtn:function(e,t){t.pidList?this.checkedItems=t.pidList:this.checkedItems=[],this.hasitem=[];var a=t.cycletype;switch(this.cycleNum=t.cycletype,a){case 1:this.dateShow1=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1,this.region=t.cycletime;break;case 2:this.dateShow2=!0,this.dateShow1=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow5=!1,this.weekday=t.cycletime;break;case 3:this.dateShow3=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow4=!1,this.dateShow5=!1,this.monthday=t.cycletime;break;case 4:this.dateShow4=!0,this.dateShow1=!1,this.dateShow2=!1,this.dateShow3=!1,this.dateShow5=!1,this.quarter=t.cycletime;break;case 5:this.dateShow5=!0,this.dateShow2=!1,this.dateShow3=!1,this.dateShow4=!1,this.dateShow1=!1,this.daytime=t.cycletime}this.ruleVisible=!0,this.ruleTitle="编辑报送规则",this.ruleBtn="保存",this.changeNum="edit",this.addRuleForm=f()({},t),this.addRuleForm.endtime=new Date(this.addRuleForm.endtime),this.addRuleForm.starttime=new Date(this.addRuleForm.starttime),this.addRuleForm.endtime=new Date(this.addRuleForm.endtime),this.ruleIndex=e},editRuleSubmit:function(){var e=this;this.$refs.addRuleForm.validate(function(t){if(!t)return!1;var a=f()({},e.addRuleForm);e.cycleNum=e.addRuleForm.cycletype,1==e.cycleNum?a.cycletime=e.region:2==e.cycleNum?a.cycletime=e.weekday:3==e.cycleNum?a.cycletime=e.monthday:4==e.cycleNum?a.cycletime=e.quarter:5==e.cycleNum&&(a.cycletime=e.daytime),e.ruleList.splice(e.ruleIndex,1,a),e.$refs.addRuleForm.resetFields(),e.ruleVisible=!1,e.ruleIndex=-1,e.ruleTitle="",e.ruleBtn="",e.changeNum="",e.cycleNum=0})},delRuleBtn:function(e,t){this.ruleList.splice(e,1),this.ruleVisible=!1,this.$message({message:"删除成功",type:"success"})},submitRule:function(){"add"==this.changeNum?this.addRuleSubmit():this.editRuleSubmit()},selectChange:function(){this.$forceUpdate()},timestampToTime:function(e,t){var a=new Date(e.stoptime);return a.getFullYear()+"-"+((a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-")+(a.getDate()+" ")},getTypes:function(){var e=this;Object(i.s)("",function(t){e.types=t.data.obj})},tableRowClassName:function(e){var t=e.row;e.rowIndex;return-1==t.status?"noedit":3==t.status?"lagbtn":void 0},newTask:function(){var e=this,t={name:this.newtask};Object(i.d)(t,function(t){e.$message({message:"新增成功",type:"success"}),e.getTypes(),e.newtask=""})},goback:function(){var e=this;this.$confirm("<span style='color:#f00;'>数据未保存</span>，确定返回列表吗？","提示",{dangerouslyUseHTMLString:!0,type:"warning",center:!0,modal:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){e.$emit("my-event")}).catch(function(){return!1})},statusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case 3:return"滞后";case 4:return"严重滞后";case-1:return"完结"}},cellClassName:function(e){var t=e.row;e.column,e.rowIndex;switch(t.status){case 1:return"yellow";case 2:return"red";case 3:return"zh";case 4:return"zhou";case-1:return"gray"}},testFuc:function(){console.log(this.basicInfo.streetids)},addLead:function(){this.changeNum="add",this.changeWord="新增",this.taskTitle="新增牵头单位",this.readOn=!1,this.addLeadVisible=!0},handleDetail2:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addLeadVisible=!0,this.addLeadData=f()({},t)},handleEdit2:function(e,t){this.changeNum="edit",this.changeWord="保存",this.taskTitle="编辑牵头单位",this.readOn=!1,this.addLeadVisible=!0,this.addLeadData=f()({},t),this.tindex=e},submitLead:function(){"read"==this.changeNum?this.addLeadVisible=!1:"add"==this.changeNum?this.addLeadSubmit():this.editLeadSubmit()},deptChange:function(){for(var e="",t="",a="",s="",l=0;l<this.leadunits.length;l++)if(this.leadunits[l].id==this.addLeadData.deptid){e=this.leadunits[l].name,t=this.leadunits[l].deptLeader,a=this.leadunits[l].deptphone;break}for(var i=0;i<this.users.length;i++)if(this.users[i].id==t){s=this.users[i].name;break}this.addLeadData.deptName=e,this.addLeadData.leaderid=t,this.addLeadData.leadername=s,this.addLeadData.leaderphone=a},addLeadSubmit:function(){var e=this;this.$refs.addLeadData.validate(function(t){if(!t)return console.log("error"),!1;var a=f()({},e.addLeadData);e.leadsData.push(a),e.$refs.addLeadData.resetFields(),e.addLeadVisible=!1})},editLeadSubmit:function(){var e=this;this.$refs.addLeadData.validate(function(t){if(!t)return!1;var a=f()({},e.addLeadData);e.leadsData.splice(e.tindex,1,a),e.$refs.addLeadData.resetFields(),e.addLeadVisible=!1,console.log(e.leadsData)})},handleDelete2:function(e,t){this.leadsData.splice(e,1),this.$refs.addLeadData.resetFields(),this.addLeadVisible=!1,this.$message({message:"删除成功",type:"success"})},addDuty:function(){this.changeNum="add",this.changeWord="新增",this.taskTitle="新增责任单位",this.readOn=!1,this.addDutyVisible=!0},handleDetail3:function(e,t){this.changeNum="read",this.changeWord="确认",this.taskTitle="详情",this.readOn=!0,this.addDutyVisible=!0,this.addDutyData=f()({},t)},handleEdit3:function(e,t){this.changeNum="edit",this.changeWord="保存",this.taskTitle="编辑责任单位",this.readOn=!1,this.addDutyVisible=!0,this.addDutyData=f()({},t),this.tindex=e},submitDuty:function(){"read"==this.changeNum?this.addDutyVisible=!1:"add"==this.changeNum?this.addDutySubmit():this.editDutySubmit()},deptChange2:function(){for(var e="",t="",a="",s="",l=0;l<this.leadunits.length;l++)if(this.leadunits[l].id==this.addDutyData.deptid){e=this.leadunits[l].name,t=this.leadunits[l].deptLeader,a=this.leadunits[l].deptphone;break}for(var i=0;i<this.users.length;i++)if(this.users[i].id==t){s=this.users[i].name;break}this.addLeadData.leaderid=t,this.addDutyData.deptName=e,this.addDutyData.leadername=s,this.addDutyData.leaderphone=a},addDutySubmit:function(){var e=this;this.$refs.addDutyData.validate(function(t){if(!t)return!1;var a=f()({},e.addDutyData);e.dutysData.push(a),e.$refs.addDutyData.resetFields(),e.addDutyVisible=!1})},editDutySubmit:function(){var e=this;this.$refs.addDutyData.validate(function(t){if(!t)return!1;var a=f()({},e.addDutyData);e.dutysData.splice(e.tindex,1,a),e.$refs.addDutyData.resetFields(),e.addDutyVisible=!1})},handleDelete3:function(e,t){this.dutysData.splice(e,1),this.$refs.addDutyData.resetFields(),this.addDutyVisible=!1,this.$message({message:"删除成功",type:"success"})},projectSubmitAll:function(){for(var e=this,t="",a=0;a<this.basicInfo.streetids.length;a++)t+=this.basicInfo.streetids[a]+",";this.basicInfo.streetids=t,this.basicInfo.streetids.length>1&&(t=t.substr(0,t.length-1)),0==this.basicInfo.arealeadids.length?this.basicInfo.arealeadids="":1==this.basicInfo.arealeadids.length?this.basicInfo.arealeadids=this.basicInfo.arealeadids[0]+",":this.basicInfo.arealeadids=this.basicInfo.arealeadids.join(",");var s=this.basicInfo;s.leaderList=this.leadsData,s.dutyList=this.dutysData,s.ruleList=this.ruleList,s.id=this.projectId,s=m()(s),Object(i.k)(s,function(t){var a={pid:e.projectId};Object(i.g)(a,function(t){Object(i.t)({pid:e.projectId},function(t){e.$emit("my-event"),e.$emit("mykey-event"),e.$message({message:"提交成功",type:"success"})})})})}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addproject"},[a("div",{staticClass:"back"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.goback}},[e._v("返回")])],1),e._v(" "),a("div",{staticClass:"addcontent",style:e.theight},[a("el-row",{staticClass:"box",staticStyle:{display:"flex","align-items":"stretch"},attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("fieldset",{staticStyle:{height:"100%"}},[a("legend",[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"boxcontent basicbox detail-basic2"},[a("el-form",{ref:"basicInfo",attrs:{"label-width":"120px",size:"medium",rules:e.rules,model:e.basicInfo}},[a("el-form-item",{attrs:{label:"项目名称：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.basicInfo.name,callback:function(t){e.$set(e.basicInfo,"name",t)},expression:"basicInfo.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目业主：",prop:"owndeptid"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{change:function(t){e.selectChange()}},model:{value:e.basicInfo.owndeptid,callback:function(t){e.$set(e.basicInfo,"owndeptid",t)},expression:"basicInfo.owndeptid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"ww1",attrs:{label:"牵头区领导：",prop:"arealeadids"}},[a("el-select",{attrs:{filterable:"","collapse-tags":"",multiple:"",clearable:"",placeholder:"请选择"},on:{change:e.selectChange},model:{value:e.basicInfo.arealeadids,callback:function(t){e.$set(e.basicInfo,"arealeadids",t)},expression:"basicInfo.arealeadids"}},e._l(e.leaderUsers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"ww1",attrs:{label:"所属街道：",prop:"streetids"}},[a("el-select",{attrs:{filterable:"",multiple:"","collapse-tags":"",clearable:"",placeholder:"请选择"},on:{change:e.selectChange},model:{value:e.basicInfo.streetids,callback:function(t){e.$set(e.basicInfo,"streetids",t)},expression:"basicInfo.streetids"}},e._l(e.streetdatas,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"项目类别：",prop:"category"}},[a("el-radio",{attrs:{label:"0"},on:{change:e.selectChange},model:{value:e.basicInfo.category,callback:function(t){e.$set(e.basicInfo,"category",t)},expression:"basicInfo.category"}},[e._v("一般项目")]),e._v(" "),a("el-radio",{attrs:{label:"1"},on:{change:e.selectChange},model:{value:e.basicInfo.category,callback:function(t){e.$set(e.basicInfo,"category",t)},expression:"basicInfo.category"}},[e._v("重点项目")])],1),e._v(" "),a("el-form-item",{attrs:{label:"项目地址：",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.basicInfo.address,callback:function(t){e.$set(e.basicInfo,"address",t)},expression:"basicInfo.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经纬度：",prop:"mapitude"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.basicInfo.mapitude,callback:function(t){e.$set(e.basicInfo,"mapitude",t)},expression:"basicInfo.mapitude"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"报送要求：",prop:"submitres"}},[a("el-input",{attrs:{type:"textarea",rows:2},model:{value:e.basicInfo.submitres,callback:function(t){e.$set(e.basicInfo,"submitres",t)},expression:"basicInfo.submitres"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目描述：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",rows:2},model:{value:e.basicInfo.remark,callback:function(t){e.$set(e.basicInfo,"remark",t)},expression:"basicInfo.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"目标任务：",prop:"aimplan"}},[a("el-input",{attrs:{type:"textarea",rows:2},model:{value:e.basicInfo.aimplan,callback:function(t){e.$set(e.basicInfo,"aimplan",t)},expression:"basicInfo.aimplan"}})],1)],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("fieldset",{staticClass:"plist",staticStyle:{height:"100%",overflow:"hidden"}},[a("legend",[e._v("报送材料")]),e._v(" "),a("div",{staticClass:"unitbox",staticStyle:{padding:"15px"}},[a("div",{staticClass:"speed"},[a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("上次进展情况：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.lastprogress,function(t,s){return a("p",{key:s},[e._v(e._s(t.question))])}))]),e._v(" "),a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("进展情况：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.newReportList,function(t,s){return a("p",{key:s},[e._v(e._s(t.question))])}))]),e._v(" "),a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("存在问题：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.newReportList,function(t,s){return a("p",{key:s},[e._v(e._s(t.wenti))])}))]),e._v(" "),a("div",{staticClass:"pbox"},[a("p",{staticClass:"tt"},[e._v("下步工作计划：")]),e._v(" "),a("div",{staticClass:"conbox"},e._l(e.newReportList,function(t,s){return a("p",{key:s},[e._v(e._s(t.measure))])}))]),e._v(" "),a("div",{staticClass:"filelist"},[a("p",{staticClass:"tt"},[e._v("附件")]),e._v(" "),a("div",{staticClass:"list"},[a("div",e._l(e.newReportList,function(t,s){return a("div",{key:s},e._l(t.newFiles,function(t,s){return a("div",{key:s},[a("a",{staticClass:"filetitle",staticStyle:{"text-align":"left"},attrs:{href:t.url,target:"_blank"}},[e._v(e._s(s+1)+". "+e._s(t.name))])])}))}))])])])])])])],1),e._v(" "),a("el-row",{staticClass:"box",attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("fieldset",[a("legend",[e._v("牵头单位")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-button",{staticClass:"addbtn",attrs:{size:"small",type:"primary"},on:{click:e.addLead}},[e._v("新 增")]),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.leadsData,"highlight-current-row":"","cell-class-name":e.cellClassName,height:"150px"}},[a("el-table-column",{attrs:{prop:"deptName",label:"牵头单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"责任领导"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentname",label:"经办人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"formstatus",label:"报送状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tag",{attrs:{size:"small"}},[1==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#fbe804"}}):2==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#f00"}}):-1==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#999"}}):a("i",{staticClass:"fa mark"}),e._v(" "),a("span",{domProps:{innerHTML:e._s(e.formstatusFormat(t,t.row.formstatus))}})])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleEdit2(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDelete2(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)]),e._v(" "),a("br"),e._v(" "),a("fieldset",[a("legend",[e._v("责任单位")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-button",{staticClass:"addbtn",attrs:{size:"small",type:"primary"},on:{click:e.addDuty}},[e._v("新 增")]),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.dutysData,"highlight-current-row":"","cell-class-name":e.cellClassName,height:"150px"}},[a("el-table-column",{attrs:{prop:"deptName",label:"责任单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadername",label:"责任领导"}}),e._v(" "),a("el-table-column",{attrs:{prop:"agentname",label:"经办人"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleEdit3(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDelete3(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("fieldset",{staticStyle:{width:"100%"}},[a("legend",[e._v("报送规则")]),e._v(" "),a("div",{staticClass:"boxcontent"},[a("el-button",{staticClass:"addbtn",attrs:{size:"small",type:"primary"},on:{click:e.addRuleBtn}},[e._v("新 增")]),e._v(" "),a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{border:"",data:e.ruleList,"highlight-current-row":"","cell-class-name":e.cellClassName,height:"435px"}},[a("el-table-column",{attrs:{prop:"stagename",label:"阶段"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cycletype",label:"报送周期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(e.ctypeFormat(t,t.row.cycletype))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"cycletime",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.cycletype?a("p",[e._v("每隔"+e._s(t.row.cycletime)+"天")]):e._e(),e._v(" "),2==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime))]):3==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime)+"日")]):4==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime)+"日")]):5==t.row.cycletype?a("p",[e._v(e._s(t.row.cycletime))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"warnday",width:"110px",label:"提前预警(天)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"starttime",formatter:e.starttimeToTime,label:"开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"endtime",formatter:e.endtimeToTime,label:"结束时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.editRuleBtn(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticClass:"btn",on:{click:function(a){e.delRuleBtn(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)])])],1)],1),e._v(" "),a("div",{staticClass:"goback"},[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.goback}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.projectSubmitAll}},[e._v("保 存")])],1),e._v(" "),a("el-dialog",{staticClass:"rule-dialog",attrs:{title:e.ruleTitle,visible:e.ruleVisible,width:"700px"},on:{"update:visible":function(t){e.ruleVisible=t}}},[a("el-form",{ref:"addRuleForm",attrs:{model:e.addRuleForm,"label-width":"93px",inline:!0,"append-to-body":!0,size:"small"}},[a("el-form-item",{attrs:{label:"阶段：",prop:"stagename"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addRuleForm.stagename,callback:function(t){e.$set(e.addRuleForm,"stagename",t)},expression:"addRuleForm.stagename"}})],1),e._v(" "),a("el-form-item",{staticClass:"day",attrs:{label:"提前：",prop:"warnday"}},[a("el-input",{model:{value:e.addRuleForm.warnday,callback:function(t){e.$set(e.addRuleForm,"warnday",t)},expression:"addRuleForm.warnday"}},[a("template",{slot:"append"},[e._v("天预警")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"报送周期：",prop:"cycletype"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){e.cycleChange()}},model:{value:e.addRuleForm.cycletype,callback:function(t){e.$set(e.addRuleForm,"cycletype",t)},expression:"addRuleForm.cycletype"}},e._l(e.submitType,function(e){return a("el-option",{key:e.value,attrs:{label:e.type,value:e.value}})}))],1),e._v(" "),e.dateShow1?a("el-form-item",{staticClass:"day",attrs:{label:"每隔：",prop:"region"}},[a("el-input",{model:{value:e.region,callback:function(t){e.region=t},expression:"region"}},[a("template",{slot:"append"},[e._v("天报送")])],2)],1):e._e(),e._v(" "),e.dateShow2?a("el-form-item",{attrs:{label:"日期：",prop:"weekday"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}},e._l(e.weekList,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow3?a("el-form-item",{attrs:{label:"日期：",prop:"monthday"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.monthday,callback:function(t){e.monthday=t},expression:"monthday"}},e._l(e.timeday,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow4?a("el-form-item",{attrs:{label:"日期：",prop:"quarter"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.quarter,callback:function(t){e.quarter=t},expression:"quarter"}},e._l(e.timeday,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1):e._e(),e._v(" "),e.dateShow5?a("el-form-item",{attrs:{label:"日期：",prop:"daytime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.daytime,callback:function(t){e.daytime=t},expression:"daytime"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"starttime",rules:[{required:!0,message:"时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.addRuleForm.starttime,callback:function(t){e.$set(e.addRuleForm,"starttime",t)},expression:"addRuleForm.starttime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"endtime",rules:[{required:!0,message:"时间不能为空",trigger:"change"}]}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.addRuleForm.endtime,callback:function(t){e.$set(e.addRuleForm,"endtime",t)},expression:"addRuleForm.endtime"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitRule}},[e._v(e._s(e.ruleBtn))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog task-dialog2",attrs:{title:e.taskTitle,visible:e.addLeadVisible,width:"800px"},on:{"update:visible":function(t){e.addLeadVisible=t}}},[a("el-form",{ref:"addLeadData",attrs:{inline:!0,model:e.addLeadData,"label-width":"100px","append-to-body":!0}},[a("div",{staticClass:"leabox"},[a("el-form-item",{attrs:{label:"牵头单位：",prop:"deptid",rules:[{required:!0,message:"请选择牵头单位",trigger:"change"}]}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:e.deptChange},model:{value:e.addLeadData.deptid,callback:function(t){e.$set(e.addLeadData,"deptid",t)},expression:"addLeadData.deptid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"责任领导：",prop:"leadername"}},[a("el-input",{model:{value:e.addLeadData.leadername,callback:function(t){e.$set(e.addLeadData,"leadername",t)},expression:"addLeadData.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"leaderphone"}},[a("el-input",{model:{value:e.addLeadData.leaderphone,callback:function(t){e.$set(e.addLeadData,"leaderphone",t)},expression:"addLeadData.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人：",prop:"agentname"}},[a("el-input",{model:{value:e.addLeadData.agentname,callback:function(t){e.$set(e.addLeadData,"agentname",t)},expression:"addLeadData.agentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"agentphone"}},[a("el-input",{model:{value:e.addLeadData.agentphone,callback:function(t){e.$set(e.addLeadData,"agentphone",t)},expression:"addLeadData.agentphone"}})],1),e._v(" "),a("div",{staticClass:"leabox leabox2"},[a("el-form-item",{attrs:{label:"工作职责：",prop:"duty"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10}},model:{value:e.addLeadData.duty,callback:function(t){e.$set(e.addLeadData,"duty",t)},expression:"addLeadData.duty"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitLead}},[e._v(e._s(e.changeWord))])],1)],1),e._v(" "),a("el-dialog",{staticClass:"task-dialog task-dialog2",attrs:{title:e.taskTitle,visible:e.addDutyVisible,width:"800px"},on:{"update:visible":function(t){e.addDutyVisible=t}}},[a("el-form",{ref:"addDutyData",attrs:{inline:!0,model:e.addDutyData,"label-width":"100px","append-to-body":!0}},[a("div",{staticClass:"leabox"},[a("el-form-item",{attrs:{label:"责任单位：",prop:"deptid",rules:[{required:!0,message:"请选择责任单位",trigger:"change"}]}},[a("el-select",{attrs:{clearable:"",filterable:"",readonly:e.readOn,placeholder:"请选择"},on:{change:e.deptChange2},model:{value:e.addDutyData.deptid,callback:function(t){e.$set(e.addDutyData,"deptid",t)},expression:"addDutyData.deptid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"责任领导：",prop:"leadername"}},[a("el-input",{model:{value:e.addDutyData.leadername,callback:function(t){e.$set(e.addDutyData,"leadername",t)},expression:"addDutyData.leadername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"leaderphone"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.leaderphone,callback:function(t){e.$set(e.addDutyData,"leaderphone",t)},expression:"addDutyData.leaderphone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人：",prop:"agentname"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.agentname,callback:function(t){e.$set(e.addDutyData,"agentname",t)},expression:"addDutyData.agentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"agentphone"}},[a("el-input",{attrs:{readonly:e.readOn},model:{value:e.addDutyData.agentphone,callback:function(t){e.$set(e.addDutyData,"agentphone",t)},expression:"addDutyData.agentphone"}})],1),e._v(" "),a("div",{staticClass:"leabox leabox2"},[a("el-form-item",{attrs:{label:"工作职责：",prop:"duty"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10},readonly:e.readOn},model:{value:e.addDutyData.duty,callback:function(t){e.$set(e.addDutyData,"duty",t)},expression:"addDutyData.duty"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitDuty}},[e._v(e._s(e.changeWord))])],1)],1)],1)},staticRenderFns:[]};var S=a("VU/8")(_,k,!1,function(e){a("cxch")},null,null).exports,x=a("qAgM"),C=a("Vi22"),j=a("Vbf0"),L={name:"project",components:{addInfo:y,detailInfo:D,editInfo:S,batchRule:x.a,importFile:C.a,reportProgress:j.a},data:function(){return{downTypeVisible:!1,downType:"",upbtnDisabled:!1,showYearbox:!1,isExport:{visible:!0},itemShow:1,reportid:-1,reportBasic:{},isCenter:3,allitems:[],laststate:"",lastprogress:[],isss:!0,toolShow:!1,activeClass:0,tabitem:["全部项目","重点项目","一般项目"],listData:[],datas:[],spanArr:[],spanIndex:0,loginname:JSON.parse(this.$store.getters.userdata).logname,loginid:JSON.parse(this.$store.getters.userdata).id,login:JSON.parse(this.$store.getters.userdata),projectCheckList:JSON.parse(this.$store.getters.userdata).projectCheckList,isAddShow:!1,isEditShow:!1,isReportShow:!1,isOverShow:!1,isDownShow:!1,currentPage:1,pageSize:10,totals:0,activeName:"first",reportVisible:{visible:!1},loading:!0,filters:{},leadunits:[],users:[],leaderUsers:[],streetdatas:[],totalStatus:[{value:0,status:"正常"},{value:3,status:"滞后"},{value:4,status:"严重滞后"},{value:-1,status:"完结"}],formStatus:[{value:0,status:"正常"},{value:1,status:"预警"},{value:2,status:"逾期"},{value:-1,status:"完结"}],selfCommit:[{value:0,name:"正常"},{value:1,name:"滞后"},{value:2,name:"严重滞后"}],wayslist:[{value:0,name:"自动预警"},{value:1,name:"手动预警"},{value:-1,name:"完结"}],types:[],category:[{value:0,cate:"一般项目"},{value:1,cate:"重点项目"}],addShow:!1,isShow:!0,detailShow:!1,editShow:!1,reportData:{},fileList:[],projectId:"-1",projectDetailData:{},leadsData:[],dutysData:[],ruleList:[],aims:[],filepath:[],basicInfo:{},pstatus:"",pcategory:1,upfile:"",imgIp:"",cellhidden:[],showitemlist:[{name:"目标任务",value:1},{name:"进展情况",value:2},{name:"下步工作计划",value:3},{name:"牵头单位",value:4},{name:"责任单位",value:5},{name:"项目业主",value:6},{name:"牵头区领导",value:7},{name:"所属街道",value:8},{name:"项目类别",value:9},{name:"项目地址",value:10},{name:"存在问题",value:11}],tableHeight:"500px",historyHeight:"500px",ishidden1:!0,ishidden2:!0,ishidden3:!0,ishidden4:!0,ishidden5:!0,ishidden6:!0,ishidden7:!0,ishidden8:!0,ishidden9:!0,ishidden10:!0,ishidden11:!0,addheight:"height:500px",addheight2:"height:500px",theight:"400px",batchHeight:"",colums:"",moreText:"更多搜索条件",isOpen:0,noEdit:!0,fileArr:[],defaturl:"",importdataVisible:{visible:!1},pdatalist:[],importProjectList:"",filedatas:[],newReportList:[],newFiles:[],rowinfo:{},batchVisible:!1,allShow:!0}},mounted:function(){},created:function(){this.upfile=s.j,this.imgIp=s.a,this.defaturl=l.a,this.importProjectList=s.f,this.hiddenDatas(),this.browerHeight(),this.isshowCheck(),this.passValue(),this.getProjectAll(),this.getDeptlist(),this.getUsers(),this.getTypes(),this.getLeaderList(),this.getStreetList(),this.centerDetail()},methods:{projectDownload:function(){this.downTypeVisible=!0},downDatalist:function(){1==this.downType?window.open(this.defaturl+"/report/createProjectReport"):window.open(this.defaturl+"/ProjectExport2Word/export"),this.downTypeVisible=!1},getAllDatas:function(){var e=this;Object(i.l)("",function(t){null==t.data.obj?e.allitems=[]:e.allitems=t.data.obj})},batchRule:function(){this.allShow=!1,this.batchVisible=!0,this.getAllDatas()},batchBack:function(){this.allShow=!0,this.batchVisible=!1,this.getProjectAll()},loadData:function(){this.importdataVisible.visible=!0,this.showYearbox=!1,this.upbtnDisabled=!1},downMoudle:function(){window.open(this.defaturl+"/templateDownload/projectTemplateDown")},numberFormatter:function(e,t,a,s){return s+1+(this.currentPage-1)*this.pageSize},totalstateChange:function(e,t){var a=this,s={totalstatus:t.totalstatus,projectid:t.projectId};Object(i.x)(s,function(e){a.getProjectAll(),a.$message({type:"success",message:"修改状态成功!"})})},formstateChange:function(e,t){var a=this,s={formstatus:t.formstatus,projectid:t.projectId};Object(i.u)(s,function(e){a.getProjectAll(),a.$message({type:"success",message:"修改状态成功!"})})},browerHeight:function(){var e=document.body.clientHeight,t=e-380,a=e-290,s=e-280,l=e-360,i=e-250;this.tableHeight=t+"px",this.historyHeight=a+"px",this.batchHeight=i+"px",this.addheight="height:"+t+"px",this.addheight2="height:"+s+"px",this.theight="height:"+l+"px"},hiddenDatas:function(){var e=this,t={userid:this.loginid,catagory:0};Object(r.B)(t,function(t){e.cellhidden=t.data.obj,e.showItems()})},moreSearch:function(){0==this.isOpen?(this.isOpen=1,this.toolShow=!0,this.moreText="收回"):(this.isOpen=0,this.toolShow=!1,this.moreText="更多搜索条件")},showItems:function(){this.ishidden1=!0,this.ishidden2=!0,this.ishidden3=!0,this.ishidden4=!0,this.ishidden5=!0,this.ishidden6=!0,this.ishidden7=!0,this.ishidden8=!0,this.ishidden9=!0,this.ishidden10=!0,this.ishidden11=!0;for(var e=0;e<this.cellhidden.length;e++){switch(this.cellhidden[e]){case 1:this.ishidden1=!1;break;case 2:this.ishidden2=!1;break;case 3:this.ishidden3=!1;break;case 4:this.ishidden4=!1;break;case 5:this.ishidden5=!1;break;case 6:this.ishidden6=!1;break;case 7:this.ishidden7=!1;break;case 8:this.ishidden8=!1;break;case 9:this.ishidden9=!1;break;case 10:this.ishidden10=!1;break;case 11:this.ishidden11=!1}}},itemChange:function(){var e=this;this.$forceUpdate(),0==this.cellhidden.length?this.colums="":1==this.cellhidden.length?this.colums=this.cellhidden[0]+",":this.colums=this.cellhidden.join(",");var t={colums:this.colums,userId:this.loginid,catagory:0};Object(r.o)(t,function(t){e.hiddenDatas(),e.showItems(),e.colums=""})},isshowCheck:function(){if(null!==this.projectCheckList)for(var e=0;e<this.projectCheckList.length;e++){switch(this.projectCheckList[e]){case"A-add":this.isAddShow=!0;break;case"A-edit":this.isEditShow=!0;break;case"A-report":this.isReportShow=!0;break;case"A-over":this.isOverShow=!0;break;case"A-down":this.isDownShow=!0}}},selectChange:function(){this.$forceUpdate()},passValue:function(){void 0==this.$route.query.pstatus?(this.pstatus="",this.getProjectAll()):this.pstatus=this.$route.query.pstatus,this.filters.status=this.pstatus},centerDetail:function(){var e=this;if(void 0==this.$route.query.projectId)this.projectId="",this.isCenter=3,this.getProjectAll();else{this.isShow=!1,this.isCenter=this.$route.query.isCenter;var t={projectid:this.projectId};Object(i.n)(t,function(e){}),this.projectId=this.$route.query.projectId;var a={type:1,detailId:this.projectId,userid:this.loginid};Object(o.i)(a,function(t){e.projectDetailData=t.data.obj,e.projectDetailData.streets=e.projectDetailData.streetDeptName,e.leadsData=e.projectDetailData.leaderDeptList,e.dutysData=e.projectDetailData.dutyDeptList,e.ruleList=e.projectDetailData.ruleList,null==e.projectDetailData.progressList&&(e.projectDetailData.progressList=[]),e.newReportList=e.projectDetailData.progressList;for(var a=0;a<e.newReportList.length;a++){e.newReportList[a].newFiles=[];var s=e.newReportList[a].filepath;if(""==s||null==s)e.newReportList[a].newFiles=[];else{var l=(s=s.split(",")).length;""==s[l-1]&&s.splice(l-1,1);for(var r=s,o=0;o<r.length;o++){var n={};n.url=e.imgIp+r[o],n.name=r[o],e.newReportList[a].newFiles.push(n)}}}0==e.projectDetailData.category?e.projectDetailData.category="一般项目":e.projectDetailData.category="重点项目",-1==e.projectDetailData.totalstatus?e.noEdit=!1:e.noEdit=!0,e.detailShow=!0,Object(i.p)({projectid:e.projectId},function(t){e.lastprogress=t.data.obj})})}},getProjectAll:function(){var e=this;this.loading=!0;var t=this.filters;t.userid=this.loginid,t.pageSize=this.pageSize,t.pageNum=this.currentPage,t.status=this.pstatus,Object(i.r)(t,function(t){null==t.data.obj?(e.totals=0,e.listData=[],e.loading=!1):(e.listData=t.data.obj.datas,e.totals=t.data.obj.total,e.loading=!1),e.showItems()})},handleSizeChange:function(e){this.pageSize=e,this.getProjectAll()},handleCurrentChange:function(e){this.currentPage=e,this.getProjectAll()},handleClick:function(e){var t=this;if(this.activeClass=e,this.$refs.filters.resetFields(),1==this.activeClass){this.filters.category=1;var a={pageSize:this.pageSize,pageNum:this.currentPage,category:1,userid:this.loginid};Object(i.r)(a,function(e){null==e.data.obj?(t.listData=[],t.totals=0):(t.listData=e.data.obj.datas,t.totals=e.data.obj.total)})}else if(2==this.activeClass){this.filters.category=0;var s={pageSize:this.pageSize,pageNum:this.currentPage,category:0,userid:this.loginid};Object(i.r)(s,function(e){null==e.data.obj?(t.listData=[],t.totals=0):(t.listData=e.data.obj.datas,t.totals=e.data.obj.total)})}else{this.filters.category="";var l={pageSize:this.pageSize,pageNum:this.currentPage,userid:this.loginid};Object(i.r)(l,function(e){null==e.data.obj?(t.listData=[],t.totals=0):(t.listData=e.data.obj.datas,t.totals=e.data.obj.total)})}},getDeptlist:function(){var e=this;Object(r.e)("",function(t){e.leadunits=t.data.obj})},getUsers:function(){var e=this;Object(r.f)("",function(t){e.users=t.data.obj})},getLeaderList:function(){var e=this;Object(r.G)("",function(t){e.leaderUsers=t.data.obj})},getStreetList:function(){var e=this;Object(r.O)("",function(t){e.streetdatas=t.data.obj})},getTypes:function(){var e=this;Object(i.s)("",function(t){e.types=t.data.obj})},getDatas:function(){var e=this,t=this.filters;t.userid=this.loginid,t.pageSize=this.pageSize,t.pageNum=this.currentPage,Object(i.r)(t,function(t){null==t.data.obj?(e.listData=[],e.totals=0):(e.listData=t.data.obj.datas,e.totals=t.data.obj.total,e.showItems())})},resetForm:function(e){var t=this;if(1==this.activeClass){var a={userid:this.loginid,pageSize:this.pageSize,pageNum:this.currentPage,status:"",category:1};Object(i.r)(a,function(a){t.listData=a.data.obj.datas,t.totals=a.data.obj.total,t.$refs[e].resetFields(),t.filters.category=1,t.filters.status="",t.showItems()})}else if(2==this.activeClass){var s={userid:this.loginid,pageSize:this.pageSize,pageNum:this.currentPage,status:"",category:0};Object(i.r)(s,function(a){t.listData=a.data.obj.datas,t.totals=a.data.obj.total,t.$refs[e].resetFields(),t.filters.category=0,t.filters.status="",t.showItems()})}else{var l={userid:this.loginid,pageSize:this.pageSize,pageNum:this.currentPage,status:"",category:""};Object(i.r)(l,function(a){t.listData=a.data.obj.datas,t.totals=a.data.obj.total,t.$refs[e].resetFields(),t.filters.category="",t.filters.status="",t.showItems()})}},statusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case 3:return"滞后";case 4:return"严重滞后";case-1:return"完结"}},totalstatusFormat:function(e,t){switch(t){case 0:return"正常";case 3:return"滞后";case 4:return"严重滞后";case-1:return"完结"}},formstatusFormat:function(e,t){switch(t){case 0:return"正常";case 1:return"预警";case 2:return"逾期";case-1:return"完结"}},cellClassName:function(e){var t=e.row,a=(e.column,e.rowIndex,t.totalstatus);t.formstatus;switch(a){case 3:return"zh";case 4:return"zhou";case-1:return"gray"}},categoryFormat:function(e,t){return 0==t?"一般项目":"重点项目"},handleDetail:function(e,t,a){var s=this;this.isShow=!1,this.detailShow=!0,this.projectId=a;var l={projectid:a};Object(i.n)(l,function(e){});var r={projectid:a};-1==t.totalstatus?this.noEdit=!1:this.noEdit=!0,Object(i.o)(r,function(e){s.projectDetailData=e.data.obj,s.projectDetailData.streets=s.projectDetailData.streetDeptName,null==s.projectDetailData.progressList&&(s.projectDetailData.progressList=[]),s.newReportList=s.projectDetailData.progressList;for(var t=0;t<s.newReportList.length;t++){s.newReportList[t].newFiles=[];var a=s.newReportList[t].filepath;if(""==a||null==a)s.newReportList[t].newFiles=[];else{var l=(a=a.split(",")).length;""==a[l-1]&&a.splice(l-1,1);for(var r=a,o=0;o<r.length;o++){var n={};n.url=s.imgIp+r[o],n.name=r[o],s.newReportList[t].newFiles.push(n)}}}s.leadsData=s.projectDetailData.leaderDeptList,s.dutysData=s.projectDetailData.dutyDeptList,s.ruleList=s.projectDetailData.ruleList,0==s.projectDetailData.category?s.projectDetailData.category="一般项目":s.projectDetailData.category="重点项目",Object(i.p)({projectid:s.projectId},function(e){s.lastprogress=e.data.obj})})},handleLag:function(e,t){var a=this;4==e.status?this.$message({message:"已设置严重滞后"}):this.$confirm("确定将此项目标设置为严重滞后吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={projectid:t};Object(i.v)(e,function(e){a.$message({type:"success",message:"操作成功!"}),a.getProjectAll()})}).catch(function(){a.$message({type:"info",message:"取消操作"})})},updateEnd:function(e,t){var a=this;-1==e.status?this.$message({message:"已完结"}):this.$confirm("此操作将完结该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={projectid:t};Object(i.w)(e,function(e){a.$message({type:"success",message:"完结成功!"}),a.getProjectAll()})}).catch(function(){a.$message({type:"info",message:"取消完结"})})},tableRowClassName:function(e){var t=e.row;e.rowIndex;if(-1==t.totalstatus)return"noedit"},editFuc:function(e){var t=this;Object(i.o)(e,function(e){t.basicInfo.remark=e.data.obj.remark,t.basicInfo.address=e.data.obj.address,t.basicInfo.name=e.data.obj.projectName,t.basicInfo.owndeptid=t.rowinfo.ownid,t.basicInfo.category=String(e.data.obj.category),t.basicInfo.address=e.data.obj.address,t.basicInfo.mapitude=e.data.obj.mapitude,t.basicInfo.submitres=e.data.obj.submitres,t.basicInfo.remark=e.data.obj.remark;var a=[];if(null==t.rowinfo.areaLeader)a=[];else for(var s=0;s<t.rowinfo.areaLeader.length;s++)a.push(t.rowinfo.areaLeader[s].id);var l=[];if(null==t.rowinfo.streetDept)l=[];else for(var r=0;r<t.rowinfo.streetDept.length;r++)l.push(t.rowinfo.streetDept[r].id);t.basicInfo.arealeadids=a,t.basicInfo.streetids=l,t.leadsData=e.data.obj.leaderDeptList,t.dutysData=e.data.obj.dutyDeptList,t.ruleList=e.data.obj.ruleList,null==e.data.obj.progressList&&(e.data.obj.progressList=[]),t.newReportList=e.data.obj.progressList;for(var o=0;o<t.newReportList.length;o++){t.newReportList[o].newFiles=[];var n=t.newReportList[o].filepath;if(""==n||null==n)t.newReportList[o].newFiles=[];else{var d=(n=n.split(",")).length;""==n[d-1]&&n.splice(d-1,1);var c=n;for(r=0;r<c.length;r++){var u={};u.url=t.imgIp+c[r],u.name=c[r],t.newReportList[o].newFiles.push(u)}}}null==t.leadsData&&(t.leadsData=[]),null==t.dutysData&&(t.dutysData=[]),null==t.ruleList&&(t.ruleList=[]),Object(i.p)({projectid:t.projectId},function(e){t.lastprogress=e.data.obj})})},handleDelete:function(e,t,a){var s=this;this.$confirm('<span style="color:#f00;">该操作将删除此条项目信息</span>，确定删除吗?',"提示",{type:"warning",dangerouslyUseHTMLString:!0}).then(function(){var e={projectid:a};Object(i.i)(e,function(e){0==e.data.code?(s.$message({message:"删除成功",type:"success"}),s.getProjectAll()):s.$message({message:"删除失败",type:"error"})})}).catch(function(){s.$message({message:"取消删除",type:"warning"})})},handleEdit:function(e,t,a){this.getTypes(),this.isShow=!1,this.editShow=!0,this.projectId=a;for(var s=0;s<this.listData.length;s++)if(this.projectId==this.listData[s].projectId){this.rowinfo=this.listData[s];break}var l={projectid:a};this.editFuc(l)},toeditPage:function(){this.isShow=!1,this.detailShow=!1,this.editShow=!0,this.getTypes();for(var e=0;e<this.listData.length;e++)if(this.projectId==this.listData[e].projectId){this.rowinfo=this.listData[e];break}var t={projectid:this.projectId};this.editFuc(t)},handleBack:function(){this.isShow=!0,this.addShow=!1,this.detailShow=!1,this.editShow=!1},handleAdd:function(){this.getTypes(),this.isShow=!1,this.addShow=!0},detailFuc:function(e){var t=this;Object(i.o)({projectid:e},function(e){t.reportBasic=e.data.obj,t.reportBasic.streets=t.reportBasic.streetDeptName,0==t.reportBasic.category?t.reportBasic.category="一般项目":t.reportBasic.category="重点项目";var a=[];if(null==e.data.obj.leaderDeptList)a=[];else for(var s=e.data.obj.leaderDeptList,l=0;l<s.length;l++)a.push(s[l].deptName);t.reportBasic.leaderDeptName=a.join(", ")})},handelReport:function(e,t,a){var s=this;this.projectId=a,this.filepath=[],this.fileList=[],this.fileArr=[],this.isExport.visible=!0,Object(i.e)({userid:this.loginid,projectid:a},function(e){s.laststate=e.data.obj.question}),this.detailFuc(a);var l={};l.projectid=a,l.userid=this.loginid,Object(o.m)(l,function(e){if(null==e.data.obj){var t={userid:s.loginid,termid:a,modeltype:1};Object(r.L)(t,function(e){var t=e.data.obj;if(null==t)s.reportData={userid:s.loginid},s.reportid=-1;else{s.isExport.visible=!1,s.reportid=t.id,s.reportData={userid:s.loginid,question:t.question,measure:t.plan,wenti:t.problem,remark:t.remark};var a=t.filepath,l={};if(null==a||""==a)s.fileList=[],s.fileArr=[];else{var i;i=(a=a.replace(/,$/gi,"")).split(",");for(var r=0;r<i.length;r++)l.name=i[r],l.url=s.imgIp+i[r],s.fileList.push(l),s.fileArr.push(l.name)}}s.reportVisible.visible=!0})}else s.$confirm("<span style='color:#f00;'>已重复报送</span>，确定继续报送吗？","提示",{dangerouslyUseHTMLString:!0,type:"warning",center:!0,modal:!1,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.isExport.visible=!1,s.reportData.userid=s.loginid,s.reportVisible.visible=!0,s.reportData.question=e.data.obj.question,s.reportData.measure=e.data.obj.measure,s.reportData.wenti=e.data.obj.wenti,s.reportData.remark=e.data.obj.remark;var t=e.data.obj.filepath,a={};if(null==t||""==t)s.fileList=[],s.fileArr=[];else{var l;l=(t=t.replace(/,$/gi,"")).split(",");for(var i=0;i<l.length;i++)a.name=l[i],a.url=s.imgIp+l[i],s.fileList.push(a),s.fileArr.push(a.name)}}).catch(function(){s.$message({type:"info",message:"取消报送"}),s.reportVisible.visible=!1})})},saveReport:function(){var e=this;this.$refs.reportChild.$refs.reportData.validate(function(t){if(t){if(0==e.fileArr.length)"";else 1==e.fileArr.length?e.fileArr[0]+",":e.fileArr.join(",");var a=e.reportData;-1==e.reportid||(a.id=e.reportid),a.modeltype=1,a.filepath="",a.termid=e.projectId,a.problem=e.reportData.wenti,a.plan=e.reportData.measure,Object(r.N)(a,function(t){e.$message({type:"success",message:"保存成功"}),e.isExport.visible=!1})}})},submitReport:function(){var e=this;this.$refs.reportChild.$refs.reportData.validate(function(t){if(t){var a="";e.fileArr==[]?a="":1==e.fileArr.length?a+=e.fileArr[0]+",":a=e.fileArr.join(",");var s=e.reportData;s.filepath=a,s.validate=0,s.projectid=e.projectId,Object(i.b)(s,function(t){e.$alert("<span style='color:#f00;'>报送成功</span>，请等待上级部门审核通过","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"我知道了",type:"success",center:!0,modal:!1}),e.reportVisible=!1,e.getProjectAll()})}})},handleRemove:function(e,t){var a=e.name;this.fileArr.splice(this.removeArr(this.fileArr,a),1)},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},handleSuccess:function(e,t){var a=e.obj;this.fileArr.push(a)}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-wrap content-wrap"},[e.allShow?a("div",[a("div",{staticClass:"tabs"},e._l(e.tabitem,function(t,s){return a("a",{key:s,staticClass:"item",class:e.activeClass==s?"active":"",attrs:{href:"javascript:;"},on:{click:function(t){e.handleClick(s)}}},[e._v(e._s(t))])})),e._v(" "),a("div",{staticClass:"project"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}]},[a("el-row",{attrs:{id:"toolbar"}},[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-form",{ref:"filters",attrs:{inline:!0,model:e.filters,size:"small"}},[a("el-form-item",{staticClass:"ld",attrs:{label:"项目名称：",prop:"pname"}},[a("el-input",{attrs:{placeholder:"请输入","auto-complete":"off"},model:{value:e.filters.pname,callback:function(t){e.$set(e.filters,"pname",t)},expression:"filters.pname"}})],1),e._v(" "),e.toolShow?a("el-form-item",{staticClass:"ld",attrs:{label:"牵头区领导：",prop:"arealeadid"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"全部"},on:{change:e.selectChange},model:{value:e.filters.arealeadid,callback:function(t){e.$set(e.filters,"arealeadid",t)},expression:"filters.arealeadid"}},e._l(e.leaderUsers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),a("el-form-item",{staticClass:"ld",attrs:{label:"牵头单位：",prop:"leaderid"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"全部"},on:{change:e.selectChange},model:{value:e.filters.leaderid,callback:function(t){e.$set(e.filters,"leaderid",t)},expression:"filters.leaderid"}},e._l(e.leadunits,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),e.toolShow?a("el-form-item",{staticClass:"ld",attrs:{label:"项目类别：",prop:"category"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},on:{change:e.selectChange},model:{value:e.filters.category,callback:function(t){e.$set(e.filters,"category",t)},expression:"filters.category"}},e._l(e.category,function(e){return a("el-option",{key:e.value,attrs:{label:e.cate,value:e.value}})}))],1):e._e(),e._v(" "),e.toolShow?a("el-form-item",{staticClass:"ld",attrs:{label:"材料报送：",prop:"formstatus"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},on:{change:e.selectChange},model:{value:e.filters.formstatus,callback:function(t){e.$set(e.filters,"formstatus",t)},expression:"filters.formstatus"}},e._l(e.formStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.status,value:e.value}})}))],1):e._e(),e._v(" "),e.toolShow?a("el-form-item",{staticClass:"ld",attrs:{label:"总体进度：",prop:"status"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},on:{change:e.selectChange},model:{value:e.filters.status,callback:function(t){e.$set(e.filters,"status",t)},expression:"filters.status"}},e._l(e.totalStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.status,value:e.value}})}))],1):e._e(),e._v(" "),a("el-form-item",{staticClass:"rebtns"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getDatas("filters")}}},[e._v("搜 索")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("filters")}}},[e._v("重 置")]),e._v(" "),a("el-button",{on:{click:e.moreSearch}},[e._v(e._s(e.moreText))])],1),e._v(" "),a("div",{staticClass:"toolbtns"},[a("div",[e.isAddShow?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("新 增")]):e._e(),e._v(" "),e.isDownShow?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.projectDownload}},[e._v("报表下载")]):e._e(),e._v(" "),e.isAddShow?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.loadData}},[e._v("导入数据")]):e._e(),e._v(" "),e.isEditShow?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.batchRule}},[e._v("报送规则")]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"选择隐藏列：",prop:"cellhidden"}},[a("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"全部"},on:{change:e.itemChange},model:{value:e.cellhidden,callback:function(t){e.cellhidden=t},expression:"cellhidden"}},e._l(e.showitemlist,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1)],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tableinfo",staticStyle:{width:"100%"},attrs:{"empty-text":"无",border:"",data:e.listData,"row-class-name":e.tableRowClassName,"highlight-current-row":"","element-loading-text":"加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.7)"}},[a("el-table-column",{attrs:{label:"序号",width:"50",formatter:e.numberFormatter}}),e._v(" "),a("el-table-column",{attrs:{prop:"projectName",label:"项目名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"1.8"},attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.row.projectName))]),e._v(" "),a("p",{staticClass:"title title-ellipsis",on:{click:function(a){e.handleDetail(t.$index,t.row,t.row.projectId)}}},[e._v(e._s(t.row.projectName))])])]}}])}),e._v(" "),e.ishidden1?a("el-table-column",{attrs:{prop:"aimplan",label:"目标任务"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},[a("p",[e._v(e._s(t.row.aimplan))])]),e._v(" "),a("p",{staticClass:"title-ellipsis"},[e._v(e._s(t.row.aimplan))])])]}}])}):e._e(),e._v(" "),e.ishidden10?a("el-table-column",{attrs:{prop:"address",label:"项目地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},[a("p",[e._v(e._s(t.row.address))])]),e._v(" "),a("p",{staticClass:"title-ellipsis"},[e._v(e._s(t.row.address))])])]}}])}):e._e(),e._v(" "),e.ishidden2?a("el-table-column",{attrs:{prop:"progressList",label:"进展情况"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},e._l(t.row.progressList,function(t,s){return a("p",{key:s},[e._v(e._s(t.question))])})),e._v(" "),a("div",e._l(t.row.progressList,function(t,s){return a("p",{key:s,staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","text-align":"left"}},[e._v(e._s(t.question))])}))])],1)]}}])}):e._e(),e._v(" "),e.ishidden11?a("el-table-column",{attrs:{prop:"progressList",label:"存在问题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},e._l(t.row.progressList,function(t,s){return a("p",{key:s},[e._v(e._s(t.wenti))])})),e._v(" "),a("div",e._l(t.row.progressList,function(t,s){return a("p",{key:s,staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","text-align":"left"}},[e._v(e._s(t.wenti))])}))])],1)]}}])}):e._e(),e._v(" "),e.ishidden3?a("el-table-column",{attrs:{prop:"progressList",label:"下步工作计划"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},e._l(t.row.progressList,function(t,s){return a("p",{key:s},[e._v(e._s(t.measure))])})),e._v(" "),a("div",e._l(t.row.progressList,function(t,s){return a("p",{key:s,staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","text-align":"left"}},[e._v(e._s(t.measure))])}))])],1)]}}])}):e._e(),e._v(" "),e.ishidden4?a("el-table-column",{attrs:{prop:"leaderDept",label:"牵头单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.leaderDept,function(t,s){return a("p",{key:s},[e._v(e._s(t.deptName))])}))]}}])}):e._e(),e._v(" "),e.ishidden5?a("el-table-column",{attrs:{prop:"dutyDept",label:"责任单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.dutyDept,function(t,s){return a("p",{key:s},[e._v(e._s(t.deptName))])}))]}}])}):e._e(),e._v(" "),e.ishidden6?a("el-table-column",{attrs:{prop:"ownName",label:"项目业主"}}):e._e(),e._v(" "),e.ishidden7?a("el-table-column",{attrs:{prop:"areaLeader",label:"牵头区领导"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.areaLeader,function(t,s){return a("p",{key:s},[e._v(e._s(t.name))])}))]}}])}):e._e(),e._v(" "),e.ishidden8?a("el-table-column",{attrs:{prop:"streetDept",label:"所属街道"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.streetDept,function(t,s){return a("p",{key:s},[e._v(e._s(t.name))])}))]}}])}):e._e(),e._v(" "),e.ishidden9?a("el-table-column",{attrs:{prop:"category",label:"项目类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{innerHTML:e._s(e.categoryFormat(t,t.row.category))}})]}}])}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"formstatus",label:"材料报送",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[1==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#fbe804"}}):2==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#f00"}}):-1==t.row.formstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#999"}}):a("i",{staticClass:"fa mark"}),e._v(" "),a("span",{domProps:{innerHTML:e._s(e.formstatusFormat(t,t.row.formstatus))}})])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"totalstatus",label:"总体进度",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEditShow?a("div",{staticClass:"flexbox editbtns"},[3==t.row.totalstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#364e98"}}):4==t.row.totalstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#7c1d77"}}):-1==t.row.totalstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#999"}}):a("i",{staticClass:"fa mark"}),e._v(" "),a("el-select",{staticClass:"stateSelect",on:{change:function(a){e.totalstateChange(t,t.row)}},model:{value:t.row.totalstatus,callback:function(a){e.$set(t.row,"totalstatus",a)},expression:"scope.row.totalstatus"}},e._l(e.totalStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.status,value:e.value}})})),e._v(" "),a("div",{staticClass:"nomask"})],1):a("div",[a("el-tag",{attrs:{size:"medium"}},[3==t.row.totalstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#364e98"}}):4==t.row.totalstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#7c1d77"}}):-1==t.row.totalstatus?a("i",{staticClass:"fa mark",staticStyle:{background:"#999"}}):a("i",{staticClass:"fa mark"}),e._v(" "),a("span",{domProps:{innerHTML:e._s(e.totalstatusFormat(t,t.row.totalstatus))}})])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn",on:{click:function(a){e.handleDetail(t.$index,t.row,t.row.projectId)}}},[e._v("详情")]),e._v(" "),e.isEditShow?a("el-button",{staticClass:"btn nobtn",on:{click:function(a){e.handleEdit(t.$index,t.row,t.row.projectId)}}},[e._v("编辑")]):e._e(),e._v(" "),e.isEditShow?a("el-button",{staticClass:"btn nobtn",on:{click:function(a){e.handleDelete(t.$index,t.row,t.row.projectId)}}},[e._v("删除")]):e._e(),e._v(" "),e.isReportShow?a("el-button",{staticClass:"btn nobtn",on:{click:function(a){e.handelReport(t.$index,t.row,t.row.projectId)}}},[e._v("进展汇报")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,40],"page-size":e.pageSize,layout:"total, prev, pager, next, sizes, jumper",total:e.totals},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("div",{staticClass:"import-data-box"},[a("import-file",{attrs:{importdataVisible:e.importdataVisible,upbtnDisabled:e.upbtnDisabled,showYearbox:e.showYearbox,itemShow:e.itemShow,importFileList:e.importProjectList},on:{"update:importdataVisible":function(t){e.importdataVisible=t},"update:upbtnDisabled":function(t){e.upbtnDisabled=t},"getAllList-event":e.getProjectAll}})],1),e._v(" "),a("el-dialog",{attrs:{title:"选择下载格式",visible:e.downTypeVisible,width:"400px"},on:{"update:visible":function(t){e.downTypeVisible=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("el-radio-group",{model:{value:e.downType,callback:function(t){e.downType=t},expression:"downType"}},[a("el-radio",{attrs:{label:1}},[e._v("Excel")]),e._v(" "),a("el-radio",{staticStyle:{"margin-left":"56px"},attrs:{label:2}},[e._v("Word")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.downDatalist}},[e._v("确 定")])],1)]),e._v(" "),e.addShow?a("div",{staticClass:"project-box"},[a("add-info",{attrs:{leadunits:e.leadunits,users:e.users,leaderUsers:e.leaderUsers,streetdatas:e.streetdatas,types:e.types,theight:e.theight},on:{"my-event":e.handleBack,"getAll-event":e.getProjectAll}})],1):e._e(),e._v(" "),e.editShow?a("div",{staticClass:"project-box"},[a("edit-info",{attrs:{leadunits:e.leadunits,users:e.users,projectId:e.projectId,basicInfo:e.basicInfo,leadsData:e.leadsData,dutysData:e.dutysData,ruleList:e.ruleList,leaderUsers:e.leaderUsers,streetdatas:e.streetdatas,types:e.types,theight:e.theight,newReportList:e.newReportList,lastprogress:e.lastprogress},on:{"my-event":e.handleBack,"mykey-event":e.getProjectAll}})],1):e._e(),e._v(" "),e.detailShow?a("div",{staticClass:"project-box"},[a("detail-info",{attrs:{projectId:e.projectId,projectDetailData:e.projectDetailData,leadsData:e.leadsData,dutysData:e.dutysData,ruleList:e.ruleList,addheight2:e.addheight2,isEditShow:e.isEditShow,noEdit:e.noEdit,historyHeight:e.historyHeight,newReportList:e.newReportList,lastprogress:e.lastprogress,isCenter:e.isCenter},on:{"my-event":e.handleBack,"edit-event":e.toeditPage}})],1):e._e()],1)]):e._e(),e._v(" "),a("div",{staticClass:"report-data-box"},[a("report-progress",{attrs:{reportVisible:e.reportVisible,reportData:e.reportData,laststate:e.laststate,itemShow:e.itemShow,workid:e.projectId,reportBasic:e.reportBasic,fileList:e.fileList,fileArr:e.fileArr,isExport:e.isExport},on:{"update:reportVisible":function(t){e.reportVisible=t},"update:fileList":function(t){e.fileList=t},"update:fileArr":function(t){e.fileArr=t},"update:isExport":function(t){e.isExport=t},"getAllList-event":e.getProjectAll}})],1),e._v(" "),e.batchVisible?a("div",{staticClass:"batchrule-box"},[a("batch-rule",{attrs:{batchHeight:e.batchHeight,allitems:e.allitems,itemShow:e.itemShow},on:{"my-back":e.batchBack}})],1):e._e()])},staticRenderFns:[]};var I=a("VU/8")(L,$,!1,function(e){a("qahJ")},null,null);t.default=I.exports},cxch:function(e,t){},qahJ:function(e,t){}});
//# sourceMappingURL=8.9637b8c644b327201340.js.map