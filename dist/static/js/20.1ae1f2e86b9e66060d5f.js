webpackJsonp([20],{"8jQJ":function(e,t){},NK0K:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("+6Bu"),r=a.n(s),i=a("woOf"),l=a.n(i),d=a("4OxD"),o=a("P9l9"),n=a("hct2"),m={name:"honorAll",components:{},data:function(){return{filters:{},honorData:[],targetCheckList:JSON.parse(this.$store.getters.userdata).targetCheckList,loginid:JSON.parse(this.$store.getters.userdata).id,isAddShow:!1,isEditShow:!1,isDownShow:!1,addFormVisible:!1,formTitle:"",addForm:{},btnWord:"",upfile:"",imgIp:"",fileList:[],deptlist:[],leaderList:[],currentStatus:"",currentPage:1,pageSize:10,totals:0,fileArr:[],countrylist:[],dateall:"",tableHeight:"450px",isReason:!0,isIssue:!1,levels:[{value:1,name:"市级"},{value:2,name:"省级"},{value:3,name:"国家级"}]}},mounted:function(){},created:function(){this.upfile=d.j,this.imgIp=d.a,this.browerHeight(),this.editLimits(),this.getDeptlist(),this.getLeaderList(),this.getAllHonor(),this.countryList()},methods:{browerHeight:function(){var e=document.body.clientHeight-380;this.tableHeight=e+"px"},editLimits:function(){if(null!==this.targetCheckList)for(var e=0;e<this.targetCheckList.length;e++){switch(this.targetCheckList[e]){case"D-add":this.isAddShow=!0;break;case"D-edit":this.isEditShow=!0;break;case"D-down":this.isDownShow=!0}}},formatter:function(e,t,a,s){return s+1+(this.currentPage-1)*this.pageSize},getDeptlist:function(){var e=this;Object(o.e)("",function(t){e.deptlist=t.data.obj})},getLeaderList:function(){var e=this;Object(o.G)("",function(t){e.leaderList=t.data.obj})},countryList:function(){var e=this;Object(n.i)("",function(t){e.countrylist=t.data.obj})},selectChange:function(){this.$forceUpdate()},getAllHonor:function(){var e=this,t={pageSize:this.pageSize,pageNum:this.currentPage,userid:this.loginid};Object(n.u)(t,function(t){e.totals=t.data.obj.total,e.honorData=t.data.obj.datas,null==e.honorData&&(e.honorData=[]);for(var a=0;a<e.honorData.length;a++){var s=e.honorData[a].files;s=null==s?[]:s.split(","),Array.prototype.removeEmpty=function(){for(var e=0;e<this.length;e++)""!=this[e]&&"undefind"!=typeof this[e]||(this.splice(e,1),e--);return this};for(var r=s.removeEmpty(),i=[],l=0;l<r.length;l++){var d={};d.url=e.imgIp+r[l],d.name=r[l],i.push(d)}e.honorData[a].flist=i}})},handleSizeChange:function(e){this.pageSize=e,this.getAllHonor()},handleCurrentChange:function(e){this.currentPage=e,this.getAllHonor()},getDatas:function(){var e=this,t=this.filters;t.pageSize=this.pageSize,t.pageNum=this.currentPage,Object(n.u)(t,function(t){e.totals=t.data.obj.total,e.honorData=t.data.obj.datas})},resetForm:function(e){this.$refs[e].resetFields(),this.getAllHonor()},handleEdit:function(e,t){this.fileList=t.flist,console.log(this.fileList),this.formTitle="编辑表彰奖牌情况填报",this.btnWord="保存",this.currentStatus="edit";var a=l()({},t),s=a;s.assistdept,s.assistleader,s.headdept,s.headleader,s.prizecounty;a=r()(s,["assistdept","assistleader","headdept","headleader","prizecounty"]),this.addForm=a,null==t.assistdeptIds&&(t.assistdeptIds=[]),null==t.assistleaderIds&&(t.assistleaderIds=[]),null==t.headdeptIds&&(t.headdeptIds=[]),null==t.headleaderIds&&(t.headleaderIds=[]),null==t.prizecountyIds&&(t.prizecountyIds=[]),this.addForm.assistdept=t.assistdeptIds,this.addForm.assistleader=t.assistleaderIds,this.addForm.headdept=t.headdeptIds,this.addForm.headleader=t.headleaderIds,this.addForm.prizecounty=t.prizecountyIds,this.addForm.isaward=String(t.isaward),this.addForm.isprize=String(t.isprize),this.timestampToTime(t.issuetime),this.addForm.issuetime=this.dateall,this.addFormVisible=!0,1==this.addForm.isaward?(this.isIssue=!0,1==this.addForm.isprize?this.isReason=!1:this.isReason=!0):(this.isIssue=!1,this.isReason=!0)},timestampToTime:function(e){var t=(e=new Date(e)).getFullYear()+"-",a=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",s=e.getDate();return this.dateall=t+a+s,this.dateall},handleAdd:function(){this.formTitle="新增表彰奖牌情况填报",this.btnWord="新增",this.addFormVisible=!0,this.currentStatus="add",this.addForm={isaward:"2",assistleader:[],assistdept:[],headleader:[],headdept:[],prizecounty:[],isprize:"2"},this.isIssue=!1,this.isReason=!0,this.fileList=[]},issueChange:function(){1==this.addForm.isaward?this.isIssue=!0:(this.isIssue=!1,this.addForm.isaward="2",this.addForm.prizecounty=[],this.addForm.isprize="",this.addForm.workremark="")},prizeChange:function(){1==this.addForm.isprize?this.isReason=!1:(this.isReason=!0,this.addForm.reason="")},removeArr:function(e,t){for(var a=e.length;a--;)if(e[a]===t)return a;return!1},handleRemove:function(e,t){var a=e.response.obj;this.fileArr.splice(this.removeArr(this.fileArr,a),1),console.log(this.fileArr)},handleSuccess:function(e,t){this.fileArr.push(e.obj),console.log(this.fileArr)},changeArrToString:function(){this.addForm.assistdept==[]||null==this.addForm.assistdept?this.addForm.assistdept="":1==this.addForm.assistdept.length?(this.addForm.assistdept=this.addForm.assistdept.join(","),this.addForm.assistdept=this.addForm.assistdept+","):this.addForm.assistdept=this.addForm.assistdept.join(","),this.addForm.assistleader==[]||null==this.addForm.assistleader?this.addForm.assistleader="":1==this.addForm.assistleader.length?(this.addForm.assistleader=this.addForm.assistleader.join(","),this.addForm.assistleader=this.addForm.assistleader+","):this.addForm.assistleader=this.addForm.assistleader.join(","),this.addForm.headdept==[]||null==this.addForm.headdept?this.addForm.headdept="":1==this.addForm.headdept.length?(this.addForm.headdept=this.addForm.headdept.join(","),this.addForm.headdept=this.addForm.headdept+","):this.addForm.headdept=this.addForm.headdept.join(","),this.addForm.headleader==[]||null==this.addForm.headleader?this.addForm.headleader="":1==this.addForm.headleader.length?(this.addForm.headleader=this.addForm.headleader.join(","),this.addForm.headleader=this.addForm.headleader+","):this.addForm.headleader=this.addForm.headleader.join(","),this.addForm.prizecounty==[]||null==this.addForm.prizecounty?this.addForm.prizecounty="":1==this.addForm.prizecounty.length?(this.addForm.prizecounty=this.addForm.prizecounty.join(","),this.addForm.prizecounty=this.addForm.prizecounty+","):this.addForm.prizecounty=this.addForm.prizecounty.join(","),console.log(this.addForm)},submitForm:function(){"add"==this.currentStatus?(this.changeArrToString(),this.addSubmit()):(this.changeArrToString(),this.editSubmit())},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){if(t){var a="",s=l()({},e.addForm);if(e.fileArr==[])a="";else 1==e.fileArr.length?a+=e.fileArr[0]+",":a=e.fileArr.join(",");s.files=a,console.log(s),Object(n.c)(s,function(t){e.fileArr=[],e.getAllHonor(),e.$message({message:"新增成功",type:"success"}),e.addFormVisible=!1,e.currentStatus="",e.$refs.addForm.resetFields()})}})},editSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){if(t){var a="",s=l()({},e.addForm);if(e.fileArr==[])a="";else 1==e.fileArr.length?a+=e.fileArr[0]+",":a=e.fileArr.join(",");s.files=a;var i=s,d=(i.createtime,s=r()(i,["createtime"]));d.updatetime;s=r()(d,["updatetime"]),console.log(s),Object(n.p)(s,function(t){e.fileArr=[],e.getAllHonor(),e.$message({message:"新增成功",type:"success"}),e.addFormVisible=!1,e.currentStatus="",e.$refs.addForm.resetFields()})}})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap honor-fill"},[e._m(0),e._v(" "),a("el-row",[a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-form",{ref:"filters",attrs:{inline:!0,model:e.filters,size:"small"}},[a("el-form-item",{staticClass:"ww2",attrs:{label:"奖项名称：",prop:"prizeName"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.filters.prizeName,callback:function(t){e.$set(e.filters,"prizeName",t)},expression:"filters.prizeName"}})],1),e._v(" "),a("el-form-item",{staticClass:"ybox",attrs:{label:"颁发时间：",prop:"startTime"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.filters.startTime,callback:function(t){e.$set(e.filters,"startTime",t)},expression:"filters.startTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"--",prop:"endTime"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.filters.endTime,callback:function(t){e.$set(e.filters,"endTime",t)},expression:"filters.endTime"}})],1),e._v(" "),a("el-form-item",{staticClass:"ww2",attrs:{label:"牵头区领导",prop:"headLeaderId"}},[a("el-select",{attrs:{placeholder:"全部",filterable:"",clearable:""},on:{change:e.selectChange},model:{value:e.filters.headLeaderId,callback:function(t){e.$set(e.filters,"headLeaderId",t)},expression:"filters.headLeaderId"}},e._l(e.leaderList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("div",{staticClass:"toolbtns"},[a("div",[e.isAddShow?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("新 增")]):e._e(),e._v(" "),e.isDownShow?a("el-button",{attrs:{type:"primary",size:"small"}},[e._v("报表下载")]):e._e()],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.getDatas("filters")}}},[e._v("搜 索")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.resetForm("filters")}}},[e._v("重 置")])],1)],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticClass:"tableinfo",staticStyle:{width:"100%",overflow:"auto"},attrs:{border:"","max-height":e.tableHeight,data:e.honorData,"highlight-current-row":""}},[a("el-table-column",{attrs:{label:"序号",width:"70",formatter:e.formatter}}),e._v(" "),a("el-table-column",{attrs:{prop:"awardname",label:"奖项名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"awarddept",label:"颁发单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"detail",label:"评奖依据和方式"}}),e._v(" "),a("el-table-column",{attrs:{label:"目前总体完成情况"}},[a("el-table-column",{attrs:{prop:"workremark",label:"进展情况"}}),e._v(" "),a("el-table-column",{attrs:{prop:"prizecountyNames",label:"获奖区县"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.prizecountyNames,function(t,s){return a("p",{key:s},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"reason",label:"我区未获奖原因及整改措施"}})],1),e._v(" "),a("el-table-column",{attrs:{prop:"headleaderNames",label:"牵头领导"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.headleaderNames,function(t,s){return a("p",{key:s},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"headdeptNames",label:"牵头单位"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.headdeptNames,function(t,s){return a("p",{key:s},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"headduty",label:"工作职责"}}),e._v(" "),a("el-table-column",{attrs:{prop:"assistleaderNames",label:"配合领导"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.assistleaderNames,function(t,s){return a("p",{key:s},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"assistdeptNames",label:"承办单位"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.assistdeptNames,function(t,s){return a("p",{key:s},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"assistduty",label:"工作职责"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isEditShow?a("el-button",{staticClass:"btn",on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]):e._e()]}}])})],1)],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,40],"page-size":e.pageSize,layout:"total, prev, pager, next, sizes, jumper",total:e.totals},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{staticClass:"fillbox",attrs:{title:e.formTitle,visible:e.addFormVisible,width:"1100px"},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"100px",size:"small"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:14}},[a("fieldset",[a("legend",[e._v("基本信息")]),e._v(" "),a("div",{staticClass:"boxwrap"},[a("el-form-item",{attrs:{label:"奖项名称：",prop:"awardname",rules:[{required:!0,message:"奖项名称不能为空"}]}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.awardname,callback:function(t){e.$set(e.addForm,"awardname",t)},expression:"addForm.awardname"}})],1),e._v(" "),a("div",{staticClass:"blist"},[a("el-form-item",{staticClass:"level",attrs:{label:"奖项级别：",prop:"prizerank"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.selectChange},model:{value:e.addForm.prizerank,callback:function(t){e.$set(e.addForm,"prizerank",t)},expression:"addForm.prizerank"}},e._l(e.levels,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{staticClass:"date",attrs:{label:"预计颁发时间：",prop:"issuetime"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.addForm.issuetime,callback:function(t){e.$set(e.addForm,"issuetime",t)},expression:"addForm.issuetime"}})],1)],1),e._v(" "),a("div",{staticClass:"blist"},[a("el-form-item",{attrs:{label:"颁发单位：",prop:"awarddept"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.awarddept,callback:function(t){e.$set(e.addForm,"awarddept",t)},expression:"addForm.awarddept"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件名：",prop:"filename"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addForm.filename,callback:function(t){e.$set(e.addForm,"filename",t)},expression:"addForm.filename"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"linefeed",attrs:{label:"评奖依据和方式：",prop:"detail"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:4},model:{value:e.addForm.detail,callback:function(t){e.$set(e.addForm,"detail",t)},expression:"addForm.detail"}})],1)],1)]),e._v(" "),a("fieldset",{staticStyle:{height:"355px"}},[a("legend",[e._v("总体完成情况")]),e._v(" "),a("div",{staticClass:"boxwrap"},[a("el-form-item",{staticClass:"isno",attrs:{label:"颁发情况：",prop:"isaward"}},[a("el-radio",{attrs:{label:"2"},on:{change:e.issueChange},model:{value:e.addForm.isaward,callback:function(t){e.$set(e.addForm,"isaward",t)},expression:"addForm.isaward"}},[e._v("未颁发")]),e._v(" "),a("el-radio",{attrs:{label:"1"},on:{change:e.issueChange},model:{value:e.addForm.isaward,callback:function(t){e.$set(e.addForm,"isaward",t)},expression:"addForm.isaward"}},[e._v("已颁发")])],1),e._v(" "),e.isIssue?a("div",{staticClass:"show-award"},[a("el-form-item",{staticClass:"isno isno2",attrs:{label:"我区是否获奖：",prop:"isprize"}},[a("el-radio",{attrs:{label:"2"},on:{change:e.prizeChange},model:{value:e.addForm.isprize,callback:function(t){e.$set(e.addForm,"isprize",t)},expression:"addForm.isprize"}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:"1"},on:{change:e.prizeChange},model:{value:e.addForm.isprize,callback:function(t){e.$set(e.addForm,"isprize",t)},expression:"addForm.isprize"}},[e._v("是")])],1),e._v(" "),a("el-form-item",{staticClass:"areas",attrs:{label:"获奖区县：",prop:"prizecounty"}},[a("el-select",{attrs:{placeholder:"请选择",multiple:""},on:{change:e.selectChange},model:{value:e.addForm.prizecounty,callback:function(t){e.$set(e.addForm,"prizecounty",t)},expression:"addForm.prizecounty"}},e._l(e.countrylist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"remark",attrs:{label:"工作进展：",prop:"workremark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:3},model:{value:e.addForm.workremark,callback:function(t){e.$set(e.addForm,"workremark",t)},expression:"addForm.workremark"}})],1),e._v(" "),e.isReason?a("el-form-item",{staticClass:"linefeed",attrs:{label:"我区未获奖原因及整改措施：",prop:"reason"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:3},model:{value:e.addForm.reason,callback:function(t){e.$set(e.addForm,"reason",t)},expression:"addForm.reason"}})],1):e._e()],1):e._e()],1)])]),e._v(" "),a("el-col",{staticClass:"fright",attrs:{span:10}},[a("fieldset",[a("legend",[e._v("牵头单位")]),e._v(" "),a("div",{staticClass:"boxwrap"},[a("el-form-item",{attrs:{label:"牵头领导：",prop:"headleader"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},on:{change:e.selectChange},model:{value:e.addForm.headleader,callback:function(t){e.$set(e.addForm,"headleader",t)},expression:"addForm.headleader"}},e._l(e.leaderList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"牵头单位：",prop:"headdept"}},[a("el-select",{attrs:{placeholder:"请选择",multiple:""},on:{change:e.selectChange},model:{value:e.addForm.headdept,callback:function(t){e.$set(e.addForm,"headdept",t)},expression:"addForm.headdept"}},e._l(e.deptlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"remark",attrs:{label:"工作职责：",prop:"headduty"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:2},model:{value:e.addForm.headduty,callback:function(t){e.$set(e.addForm,"headduty",t)},expression:"addForm.headduty"}})],1)],1)]),e._v(" "),a("fieldset",[a("legend",[e._v("承办单位")]),e._v(" "),a("div",{staticClass:"boxwrap"},[a("el-form-item",{attrs:{label:"配合领导：",prop:"assistleader"}},[a("el-select",{attrs:{placeholder:"请选择",multiple:""},on:{change:e.selectChange},model:{value:e.addForm.assistleader,callback:function(t){e.$set(e.addForm,"assistleader",t)},expression:"addForm.assistleader"}},e._l(e.leaderList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"承办单位：",prop:"assistdept"}},[a("el-select",{attrs:{placeholder:"请选择",multiple:""},on:{change:e.selectChange},model:{value:e.addForm.assistdept,callback:function(t){e.$set(e.addForm,"assistdept",t)},expression:"addForm.assistdept"}},e._l(e.deptlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticClass:"remark",attrs:{label:"工作职责：",prop:"assistduty"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入",rows:2},model:{value:e.addForm.assistduty,callback:function(t){e.$set(e.addForm,"assistduty",t)},expression:"addForm.assistduty"}})],1)],1)]),e._v(" "),a("fieldset",[a("legend",[e._v("上传附件")]),e._v(" "),a("div",{staticClass:"boxwrap boxwrap0"},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.upfile,"file-list":e.fileList,"on-remove":e.handleRemove,"on-success":e.handleSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("添加附件")])],1)],1)])])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.submitForm("addForm")}}},[e._v(e._s(e.btnWord))])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"navtitle"},[t("span",[this._v("表彰奖牌情况填报表")])])}]};var h=a("VU/8")(m,c,!1,function(e){a("8jQJ")},null,null);t.default=h.exports}});
//# sourceMappingURL=20.1ae1f2e86b9e66060d5f.js.map